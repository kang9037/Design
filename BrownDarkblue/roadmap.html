<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤í„°ë””ì¼€ì–´ - í•™ìƒë¶€ ë¡œë“œë§µ ìƒì„±ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #fafaf9 0%, #f5f5f4 50%, #e7e5e4 100%);
            min-height: 100vh;
            padding: 180px 20px 20px 20px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 50%, rgba(202, 138, 4, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(133, 77, 14, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(71, 85, 105, 0.03) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .page-header {
            text-align: center;
            color: #854d0e;
            margin-top: 20px;
            margin-bottom: 40px;
            padding: 20px 0;
            text-shadow: 0 2px 4px rgba(133, 77, 14, 0.1);
        }

        .page-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .page-header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 40px;
            box-shadow:
                0 20px 60px rgba(139, 92, 246, 0.15),
                0 0 0 1px rgba(139, 92, 246, 0.1);
            margin-bottom: 30px;
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 12px;
            color: #333;
            font-weight: 700;
            font-size: 1.1em;
        }

        input, select, textarea {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1.1em;
            transition: all 0.3s;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #ca8a04;
            box-shadow: 0 0 0 3px rgba(202, 138, 4, 0.15);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .btn {
            padding: 20px 50px;
            border: none;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ca8a04 0%, #854d0e 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(202, 138, 4, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #854d0e 0%, #713f12 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(202, 138, 4, 0.4);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #666;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn-group {
            text-align: center;
            margin-top: 30px;
        }

        /* ============ ë¡œë”© ìƒíƒœ ìŠ¤íƒ€ì¼ ============ */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            border-radius: 20px;
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 6px solid #f0f0f0;
            border-top: 6px solid #ca8a04;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-message {
            margin-top: 30px;
            font-size: 1.3em;
            font-weight: 700;
            color: #854d0e;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* ============ íƒ€ì´í•‘ íš¨ê³¼ ============ */
        .typing-cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background: #ca8a04;
            margin-left: 3px;
            animation: blink 0.7s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* ============ ê²°ê³¼ ë¬¸ì„œ ìŠ¤íƒ€ì¼ ============ */
        .document-container {
            background: white;
            max-width: 1200px;
            margin: 0 auto;
            box-shadow: 0 0 50px rgba(0,0,0,0.1);
            border-radius: 0;
        }

        .document-header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: white;
            padding: 50px 60px;
            position: relative;
            overflow: hidden;
        }

        .document-header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 300px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .document-title {
            font-size: 2.2em;
            font-weight: 800;
            margin-bottom: 15px;
            position: relative;
        }

        .document-subtitle {
            font-size: 1.1em;
            opacity: 0.95;
            position: relative;
        }

        .document-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid rgba(255,255,255,0.3);
            position: relative;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .document-body {
            padding: 50px 60px;
        }

        .section {
            margin-bottom: 50px;
            page-break-inside: avoid;
        }

        .section-title {
            font-size: 1.6em;
            color: #333;
            font-weight: 700;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #ca8a04;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-icon {
            font-size: 1.2em;
        }

        /* ì •ë³´ ì¹´ë“œ ê·¸ë¦¬ë“œ */
        .info-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: linear-gradient(135deg, #fef9c3 0%, #fef3c7 100%);
            border: 2px solid #fde68a;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
        }

        .info-card:hover {
            transform: translateY(-5px);
        }

        .info-card-label {
            font-size: 0.85em;
            color: #854d0e;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-card-value {
            font-size: 1.3em;
            color: #333;
            font-weight: 700;
        }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            border-radius: 12px;
            overflow: hidden;
        }

        .data-table thead {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: white;
        }

        .data-table th {
            padding: 18px 20px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95em;
            letter-spacing: 0.3px;
        }

        .data-table tbody tr {
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.3s;
        }

        .data-table tbody tr:hover {
            background: #fef9c3;
        }

        .data-table td {
            padding: 16px 20px;
            color: #333;
            font-size: 0.95em;
        }

        .data-table tbody tr:last-child {
            border-bottom: none;
        }

        /* ë±ƒì§€ ìŠ¤íƒ€ì¼ */
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-right: 8px;
            margin-bottom: 5px;
        }

        .badge-primary {
            background: linear-gradient(135deg, #ca8a04 0%, #854d0e 100%);
            color: white;
        }

        .badge-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .badge-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .badge-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .badge-info {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
        }

        /* ëŒ€í•™ ì¶”ì²œ ì„¹ì…˜ */
        .university-tiers {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .tier-box {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s;
        }

        .tier-box:hover {
            border-color: #ca8a04;
            box-shadow: 0 5px 20px rgba(202, 138, 4, 0.15);
        }

        .tier-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .tier-title {
            font-size: 1.2em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tier-universities {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .university-chip {
            background: linear-gradient(135deg, #fef9c3 0%, #fef3c7 100%);
            border: 1px solid #fde68a;
            padding: 10px 18px;
            border-radius: 25px;
            font-weight: 600;
            color: #854d0e;
            font-size: 0.95em;
            transition: all 0.3s;
            cursor: default;
        }

        .university-chip:hover {
            background: linear-gradient(135deg, #ca8a04 0%, #854d0e 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(202, 138, 4, 0.3);
        }

        /* ë§ˆì¸ë“œë§µ ìŠ¤íƒ€ì¼ */
        .mindmap-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin: 30px 0;
        }

        .mindmap-year {
            position: relative;
            padding-left: 50px;
        }

        .mindmap-year::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 30px;
            bottom: 30px;
            width: 4px;
            background: linear-gradient(180deg, #ca8a04 0%, #854d0e 100%);
            border-radius: 2px;
        }

        .year-node {
            position: absolute;
            left: 8px;
            top: 20px;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #ca8a04 0%, #854d0e 100%);
            border: 4px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.85em;
            box-shadow: 0 3px 10px rgba(202, 138, 4, 0.4);
            z-index: 1;
        }

        .year-header-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        .semester-boxes {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .semester-box {
            background: linear-gradient(135deg, #fef9c3 0%, #fef3c7 100%);
            border: 2px solid #fde68a;
            border-radius: 12px;
            padding: 20px;
        }

        .semester-title {
            font-size: 1.1em;
            font-weight: 700;
            color: #854d0e;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .activity-items {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .activity-box {
            background: white;
            border-left: 4px solid #ca8a04;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .activity-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .activity-text {
            color: #333;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .activity-note {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #f0f0f0;
            font-size: 0.85em;
            color: #059669;
        }

        /* ì „ëµ ë°•ìŠ¤ */
        .strategy-box {
            background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
            border: 2px solid #fed7aa;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }

        .strategy-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #ea580c;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .strategy-content {
            color: #333;
            line-height: 1.8;
        }

        .strategy-list {
            list-style: none;
            padding-left: 0;
        }

        .strategy-list li {
            padding: 10px 0 10px 30px;
            position: relative;
        }

        .strategy-list li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #ea580c;
            font-weight: 700;
            font-size: 1.2em;
        }

        .export-section {
            background: linear-gradient(135deg, #fef9c3 0%, #fef3c7 100%);
            padding: 40px;
            border-radius: 16px;
            text-align: center;
            margin-top: 50px;
            border: 2px solid #fde68a;
        }

        .export-section h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.4em;
        }

        .export-section p {
            color: #666;
            margin-bottom: 25px;
        }

        .btn-export {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 15px 35px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-export:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        @media print {
            body {
                background: white;
            }
            .card {
                box-shadow: none;
            }
            .export-section, .btn-group {
                display: none;
            }
            .document-container {
                box-shadow: none;
            }
        }

        @media (max-width: 768px) {
            .form-row, .info-cards, .semester-boxes {
                grid-template-columns: 1fr;
            }

            .document-header, .document-body {
                padding: 30px 25px;
            }

            .document-title {
                font-size: 1.6em;
            }

            .header h1 {
                font-size: 1.8em;
            }
        }

        /* í•™êµ ê²€ìƒ‰ ê²°ê³¼ ìŠ¤íƒ€ì¼ */
        #schoolSuggestions::-webkit-scrollbar {
            width: 8px;
        }

        #schoolSuggestions::-webkit-scrollbar-track {
            background: #f0f0f0;
        }

        #schoolSuggestions::-webkit-scrollbar-thumb {
            background: #ca8a04;
            border-radius: 4px;
        }

        #schoolSuggestions::-webkit-scrollbar-thumb:hover {
            background: #854d0e;
        }

        /* ============ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ============ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            animation: fadeIn 0.3s ease-in-out;
        }

        .modal-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .modal-content {
            background: white;
            border-radius: 0;
            width: 100vw;
            height: 100vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease-out;
            box-shadow: none;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            position: sticky;
            top: 0;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: white;
            padding: 30px 40px;
            border-radius: 20px 20px 0 0;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 40px;
        }

        /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .chart-container {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .chart-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
            padding: 10px;
        }

        .chart-wrapper.full-width {
            grid-column: 1 / -1;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #fef9c3 0%, #fef3c7 100%);
            border: 2px solid #fde68a;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(202, 138, 4, 0.2);
        }

        .stat-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: 800;
            color: #854d0e;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            font-weight: 600;
        }

        .pdf-button {
            position: fixed;
            bottom: 40px;
            right: 40px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
            transition: all 0.3s;
            display: none;
            align-items: center;
            gap: 10px;
            z-index: 100;
        }

        .pdf-button.show {
            display: flex;
        }

        .pdf-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.5);
        }

        /* ì¶”ê°€ ì •ë³´ ë°•ìŠ¤ */
        .insight-box {
            background: linear-gradient(135deg, #dcfce7 0%, #d9f99d 100%);
            border-left: 4px solid #10b981;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .insight-title {
            font-weight: 700;
            color: #059669;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-content {
            color: #333;
            line-height: 1.8;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .stats-cards {
                grid-template-columns: 1fr 1fr;
            }

            .modal-body {
                padding: 20px;
            }
        }

        /* í”„ë¦°íŠ¸ ìŠ¤íƒ€ì¼ */
        @media print {
            .modal-overlay {
                position: static;
                background: none;
            }

            .modal-content {
                max-height: none;
                box-shadow: none;
            }

            .modal-close, .pdf-button {
                display: none !important;
            }

            .modal-header {
                position: static;
            }
        }

        /* ë‹¨ê³„ë³„ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .step-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease-out;
        }

        .step-card.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .step-card.completed {
            opacity: 0.7;
            pointer-events: none;
        }

        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #fbbf24;
        }

        .step-number {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-right: 15px;
            box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3);
        }

        .step-title {
            flex: 1;
        }

        .step-title h3 {
            margin: 0;
            font-size: 1.5em;
            color: #333;
        }

        .step-title p {
            margin: 5px 0 0 0;
            color: #666;
            font-size: 0.9em;
        }

        .next-step-btn {
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .next-step-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(245, 158, 11, 0.4);
        }

        .next-step-btn:active {
            transform: translateY(0);
        }
    </style>
    <link rel="stylesheet" href="css/styles.css">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- html2pdf.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ê³µí†µ í—¤ë” -->
    <div id="common-header"></div>

    <div class="container">
        <!-- ì „ì²´ ì œëª© -->
        <h2 style="margin-bottom: 40px; color: #333; font-size: 2em; text-align: center;">í•™ìƒ ë§ì¶¤í˜• ë¡œë“œë§µ ìƒì„±ì„ ìœ„í•œ ì •ë³´ ì…ë ¥</h2>

        <!-- Step 1: ê¸°ë³¸ ì •ë³´ -->
        <div class="step-card visible" id="stepCard1">
            <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">
                    <h3>ê¸°ë³¸ ì •ë³´ ì…ë ¥</h3>
                    <p>í•™ìƒì˜ ê¸°ë³¸ ì •ë³´ì™€ í¬ë§ ì§„ë¡œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                </div>
            </div>

            <div class="card">
                <!-- ê¸°ë³¸ ì •ë³´ -->
                <div style="background: linear-gradient(135deg, #fef9c3 0%, #fef3c7 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border-left: 5px solid #ca8a04;">
                    <h3 style="color: #854d0e; margin-bottom: 20px; font-size: 1.3em;">ğŸ“‹ ê¸°ë³¸ ì •ë³´</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>í•™ìƒ ì´ë¦„</label>
                            <input type="text" id="studentName" placeholder="ì˜ˆ: ê¹€ë¯¼ì¤€" value="ê¹€ë¯¼ì¤€">
                        </div>

                        <div class="form-group">
                            <label>í˜„ì¬ í•™ë…„</label>
                            <select id="currentGrade">
                                <option value="1">ê³ ë“±í•™êµ 1í•™ë…„</option>
                                <option value="2">ê³ ë“±í•™êµ 2í•™ë…„</option>
                                <option value="3">ê³ ë“±í•™êµ 3í•™ë…„</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>í•™êµëª…</label>
                        <div style="position: relative;">
                            <input type="text" id="schoolName" placeholder="í•™êµëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì„œìš¸ê³ ë“±í•™êµ)" oninput="searchSchool(this.value)">
                            <div id="schoolSuggestions" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #ca8a04; border-top: none; border-radius: 0 0 10px 10px; max-height: 200px; overflow-y: auto; z-index: 1000;"></div>
                        </div>
                        <div id="schoolInfo" style="margin-top: 10px; font-size: 0.85em; color: #333;"></div>
                    </div>

                    <div class="form-group">
                        <label>í¬ë§ ê³„ì—´</label>
                        <select id="major">
                            <option value="ìì—°ê³„ì—´">ìì—°ê³„ì—´</option>
                            <option value="ì¸ë¬¸ê³„ì—´">ì¸ë¬¸ê³„ì—´</option>
                            <option value="ì˜ˆì²´ëŠ¥ê³„ì—´">ì˜ˆì²´ëŠ¥ê³„ì—´</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>í¬ë§ í•™ê³¼/ì „ê³µ</label>
                    <div style="position: relative;">
                        <input type="text" id="department" placeholder="í•™ê³¼/ì „ê³µì„ ê²€ìƒ‰í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”" oninput="searchDepartment(this.value)" onfocus="showAllDepartments()" autocomplete="off">
                        <div id="departmentSuggestions" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #ca8a04; border-top: none; border-radius: 0 0 10px 10px; max-height: 350px; overflow-y: auto; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.15);"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label>ê´€ì‹¬ ë¶„ì•¼ / í‚¤ì›Œë“œ (ì„ íƒ)</label>
                    <textarea id="keywords" rows="3" placeholder="ì˜ˆ: ì¸ê³µì§€ëŠ¥, ë°ì´í„°ë¶„ì„, í”„ë¡œê·¸ë˜ë°, ì•Œê³ ë¦¬ì¦˜">ì¸ê³µì§€ëŠ¥, í”„ë¡œê·¸ë˜ë°, ë°ì´í„°ë¶„ì„</textarea>
                </div>

                <button type="button" class="next-step-btn" onclick="goToNextStep(2)">ë‹¤ìŒ ë‹¨ê³„: ì„±ì  ì •ë³´ ì…ë ¥ â†’</button>
            </div>
        </div>

        <!-- Step 2: ì„±ì  ì •ë³´ -->
        <div class="step-card" id="stepCard2">
            <div class="step-header">
                <div class="step-number">2</div>
                <div class="step-title">
                    <h3>ì„±ì  ì •ë³´ ì…ë ¥</h3>
                    <p>í˜„ì¬ ë˜ëŠ” ìµœê·¼ í•™ê¸° ë‚´ì‹  ë“±ê¸‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (êµ­ì˜ìˆ˜ í•„ìˆ˜)</p>
                </div>
            </div>

            <div class="card">
                <!-- ê³¼ëª©ë³„ í˜„ì¬ ë“±ê¸‰ -->
                <div style="background: linear-gradient(135deg, #dcfce7 0%, #d9f99d 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border-left: 5px solid #10b981;">
                    <h3 style="color: #059669; margin-bottom: 20px; font-size: 1.3em;">ğŸ“Š ê³¼ëª©ë³„ í˜„ì¬ ì„±ì  (ë‚´ì‹  ë“±ê¸‰)</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 0.95em;">í˜„ì¬ ë˜ëŠ” ìµœê·¼ í•™ê¸° ë‚´ì‹  ë“±ê¸‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (êµ­ì˜ìˆ˜ í•„ìˆ˜)</p>

                    <!-- í•„ìˆ˜ ê³¼ëª© -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>êµ­ì–´ <span style="color: #ef4444;">*</span></label>
                            <select id="gradeKorean" required>
                                <option value="">ì„ íƒ</option>
                                <option value="1">1ë“±ê¸‰</option>
                                <option value="2" selected>2ë“±ê¸‰</option>
                                <option value="3">3ë“±ê¸‰</option>
                                <option value="4">4ë“±ê¸‰</option>
                                <option value="5">5ë“±ê¸‰</option>
                                <option value="6">6ë“±ê¸‰</option>
                                <option value="7">7ë“±ê¸‰</option>
                                <option value="8">8ë“±ê¸‰</option>
                                <option value="9">9ë“±ê¸‰</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>ì˜ì–´ <span style="color: #ef4444;">*</span></label>
                            <select id="gradeEnglish" required>
                                <option value="">ì„ íƒ</option>
                                <option value="1">1ë“±ê¸‰</option>
                                <option value="2">2ë“±ê¸‰</option>
                                <option value="3" selected>3ë“±ê¸‰</option>
                                <option value="4">4ë“±ê¸‰</option>
                                <option value="5">5ë“±ê¸‰</option>
                                <option value="6">6ë“±ê¸‰</option>
                                <option value="7">7ë“±ê¸‰</option>
                                <option value="8">8ë“±ê¸‰</option>
                                <option value="9">9ë“±ê¸‰</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>ìˆ˜í•™ <span style="color: #ef4444;">*</span></label>
                            <select id="gradeMath" required>
                                <option value="">ì„ íƒ</option>
                                <option value="1" selected>1ë“±ê¸‰</option>
                                <option value="2">2ë“±ê¸‰</option>
                                <option value="3">3ë“±ê¸‰</option>
                                <option value="4">4ë“±ê¸‰</option>
                                <option value="5">5ë“±ê¸‰</option>
                                <option value="6">6ë“±ê¸‰</option>
                                <option value="7">7ë“±ê¸‰</option>
                                <option value="8">8ë“±ê¸‰</option>
                                <option value="9">9ë“±ê¸‰</option>
                            </select>
                        </div>
                    </div>

                    <!-- ì¶”ê°€ ê³¼ëª© ì»¨í…Œì´ë„ˆ -->
                    <div id="additionalSubjectsContainer" style="margin-top: 20px;"></div>

                    <!-- ê³¼ëª© ì¶”ê°€ ë²„íŠ¼ -->
                    <button type="button" onclick="addSubject()" style="width: 100%; padding: 12px; margin-top: 15px; background: white; color: #059669; border: 2px dashed #10b981; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#dcfce7'; this.style.borderStyle='solid';" onmouseout="this.style.background='white'; this.style.borderStyle='dashed';">
                        + ì¶”ê°€ ê³¼ëª© ì…ë ¥í•˜ê¸°
                    </button>
                </div>

                <button type="button" class="next-step-btn" onclick="goToNextStep(3)">ë‹¤ìŒ ë‹¨ê³„: í™œë™ ë° ëª©í‘œ ì…ë ¥ â†’</button>
            </div>
        </div>

        <!-- Step 3: í™œë™ ë° ëª©í‘œ -->
        <div class="step-card" id="stepCard3">
            <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">
                    <h3>í™œë™ ë° ëª©í‘œ ì…ë ¥</h3>
                    <p>í™œë™ í˜„í™©ê³¼ í¬ë§ ëŒ€í•™ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                </div>
            </div>

            <div class="card">
                <!-- í™œë™ í˜„í™© -->
                <div style="background: linear-gradient(135deg, #e0e7ff 0%, #ddd6fe 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border-left: 5px solid #6366f1;">
                    <h3 style="color: #4f46e5; margin-bottom: 20px; font-size: 1.3em;">ğŸ¯ í™œë™ í˜„í™©</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 0.95em;">í˜„ì¬ê¹Œì§€ ì°¸ì—¬í•œ í™œë™ì„ ì…ë ¥í•´ì£¼ì„¸ìš”</p>

                    <div class="form-group">
                        <label>ë™ì•„ë¦¬ í™œë™ (ê°œìˆ˜)</label>
                        <input type="number" id="activityClub" placeholder="ì˜ˆ: 2" value="1" min="0" max="10">
                        <small style="color: #666; font-size: 0.85em;">ì°¸ì—¬í•œ ë™ì•„ë¦¬ ê°œìˆ˜</small>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>êµë‚´ ëŒ€íšŒ/ìˆ˜ìƒ (íšŒ)</label>
                            <input type="number" id="activityAward" placeholder="ì˜ˆ: 3" value="2" min="0">
                            <small style="color: #666; font-size: 0.85em;">êµë‚´ ëŒ€íšŒ ì°¸ê°€ ë° ìˆ˜ìƒ íšŸìˆ˜</small>
                        </div>

                        <div class="form-group">
                            <label>í”„ë¡œì íŠ¸/íƒêµ¬í™œë™ (ê°œ)</label>
                            <input type="number" id="activityProject" placeholder="ì˜ˆ: 2" value="1" min="0">
                            <small style="color: #666; font-size: 0.85em;">ê°œì¸/íŒ€ í”„ë¡œì íŠ¸ ë° íƒêµ¬í™œë™ ìˆ˜</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ì£¼ìš” í™œë™ ë‚´ìš© (ì„ íƒ)</label>
                        <textarea id="activityDetails" rows="3" placeholder="ì˜ˆ: í”„ë¡œê·¸ë˜ë° ë™ì•„ë¦¬ ë¶€ì¥, êµë‚´ ì½”ë”©ëŒ€íšŒ ê¸ˆìƒ, AI ì±—ë´‡ ì œì‘ í”„ë¡œì íŠ¸">í”„ë¡œê·¸ë˜ë° ë™ì•„ë¦¬, êµë‚´ ìˆ˜í•™ê²½ì‹œëŒ€íšŒ ì€ìƒ</textarea>
                    </div>
                </div>

                <!-- ëª©í‘œ ì„¤ì • -->
                <div style="background: linear-gradient(135deg, #fed7aa 0%, #fde68a 100%); padding: 25px; border-radius: 15px; margin-bottom: 30px; border-left: 5px solid #f59e0b;">
                    <h3 style="color: #d97706; margin-bottom: 20px; font-size: 1.3em;">ğŸ“ ëª©í‘œ ëŒ€í•™</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label>1ì§€ë§ ëŒ€í•™</label>
                            <input type="text" id="targetUniv1" placeholder="ì˜ˆ: ì„œìš¸ëŒ€í•™êµ" value="ì—°ì„¸ëŒ€í•™êµ">
                        </div>

                        <div class="form-group">
                            <label>2ì§€ë§ ëŒ€í•™</label>
                            <input type="text" id="targetUniv2" placeholder="ì˜ˆ: ì—°ì„¸ëŒ€í•™êµ" value="ì„±ê· ê´€ëŒ€í•™êµ">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>3ì§€ë§ ëŒ€í•™</label>
                            <input type="text" id="targetUniv3" placeholder="ì˜ˆ: ì¤‘ì•™ëŒ€í•™êµ" value="">
                        </div>

                        <div class="form-group">
                            <label>4ì§€ë§ ëŒ€í•™</label>
                            <input type="text" id="targetUniv4" placeholder="ì˜ˆ: ê²½í¬ëŒ€í•™êµ" value="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ê°•ì  ë° íŠ¹ê¸°ì‚¬í•­ (ì„ íƒ)</label>
                        <textarea id="strengths" rows="3" placeholder="ì˜ˆ: ìˆ˜í•™Â·ê³¼í•™ ìš°ìˆ˜, í”„ë¡œê·¸ë˜ë° ì‹¤ë ¥, ë¦¬ë”ì‹­, ì°½ì˜ì  ë¬¸ì œí•´ê²° ëŠ¥ë ¥">ìˆ˜í•™ ì„±ì  ìš°ìˆ˜, í”„ë¡œê·¸ë˜ë° ëŠ¥ë ¥</textarea>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="goToStep2()">ğŸ” AI ë§ì¶¤í˜• ë¡œë“œë§µ ìƒì„±í•˜ê¸°</button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- ëª¨ë‹¬ì°½ -->
    <div class="modal-overlay" id="reportModal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h2 style="margin: 0; font-size: 1.8em;">ğŸ“ 3ê°œë…„ ë§ì¶¤í˜• ì…ì‹œì „ëµ ë¡œë“œë§µ</h2>
                    <p style="margin: 5px 0 0 0; opacity: 0.9;">AI ê¸°ë°˜ í•™ìƒë¶€ ì¢…í•©ê´€ë¦¬ ë° ëŒ€í•™ì…ì‹œ ì „ëµ ë³´ê³ ì„œ</p>
                </div>
                <button class="modal-close" onclick="closeModal()">Ã—</button>
            </div>
            <div class="modal-body" id="reportContent">
                <div class="document-container">
                    <!-- ë¬¸ì„œ í—¤ë” ì œê±° (ëª¨ë‹¬ í—¤ë”ì™€ ì¤‘ë³µ) -->

                    <!-- ë¬¸ì„œ ë³¸ë¬¸ -->
                    <div class="document-body">

                        <!-- Section 1: í•™ìƒ ê¸°ë³¸ ì •ë³´ -->
                        <div class="section">
                            <h2 class="section-title">
                                <span class="section-icon">ğŸ‘¤</span>
                                í•™ìƒ ê¸°ë³¸ ì •ë³´
                            </h2>
                            <div class="info-cards">
                                <div class="info-card">
                                    <div class="info-card-label">í•™ìƒëª…</div>
                                    <div class="info-card-value" id="doc-name">ê¹€ë¯¼ì¤€</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-card-label">í˜„ì¬ í•™ë…„</div>
                                    <div class="info-card-value" id="doc-grade">ê³ ë“±í•™êµ 1í•™ë…„</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-card-label">í•™êµ</div>
                                    <div class="info-card-value" id="doc-school">ì„œìš¸ê³ ë“±í•™êµ</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-card-label">í¬ë§ ê³„ì—´</div>
                                    <div class="info-card-value" id="doc-major">ìì—°ê³„ì—´</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-card-label">í¬ë§ í•™ê³¼</div>
                                    <div class="info-card-value" id="doc-dept">ì»´í“¨í„°ê³µí•™ê³¼</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-card-label">ê´€ì‹¬ ë¶„ì•¼</div>
                                    <div class="info-card-value">AIÂ·í”„ë¡œê·¸ë˜ë°</div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 2: ì„±ì  ë¶„ì„ ë° ì˜ˆì¸¡ ì°¨íŠ¸ -->
                        <div class="section">
                            <h2 class="section-title">
                                <span class="section-icon">ğŸ“ˆ</span>
                                ì„±ì  ë¶„ì„ ë° ì˜ˆì¸¡
                            </h2>

                            <div class="stats-cards">
                                <div class="stat-card">
                                    <div class="stat-icon">ğŸ“š</div>
                                    <div class="stat-value">2.1</div>
                                    <div class="stat-label">í˜„ì¬ ë‚´ì‹ ë“±ê¸‰</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">ğŸ¯</div>
                                    <div class="stat-value">1.8</div>
                                    <div class="stat-label">ëª©í‘œ ë‚´ì‹ ë“±ê¸‰</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">ğŸ“Š</div>
                                    <div class="stat-value">85%</div>
                                    <div class="stat-label">ë‹¬ì„± ê°€ëŠ¥ì„±</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">ğŸ†</div>
                                    <div class="stat-value">ìƒìœ„ 12%</div>
                                    <div class="stat-label">ì „ì²´ ì„ì°¨</div>
                                </div>
                            </div>

                            <div class="charts-grid">
                                <div class="chart-container">
                                    <h3 class="chart-title">ê³¼ëª©ë³„ ì„±ì  í˜„í™© ë° ì˜ˆì¸¡</h3>
                                    <div class="chart-wrapper">
                                        <canvas id="gradeRadarChart"></canvas>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <h3 class="chart-title">ëŒ€í•™ë³„ í•©ê²© ê°€ëŠ¥ì„± ë¶„ì„</h3>
                                    <div class="chart-wrapper">
                                        <canvas id="universityDoughnutChart"></canvas>
                                    </div>
                                </div>
                            </div>

                            <div class="insight-box">
                                <div class="insight-title">ğŸ’¡ AI ë¶„ì„ ì¸ì‚¬ì´íŠ¸</div>
                                <div class="insight-content">
                                    ìˆ˜í•™ê³¼ ê³¼í•™ ê³¼ëª©ì˜ ì„±ì ì´ ìš°ìˆ˜í•˜ë©°, ì •ë³´ ê³¼ëª©ì—ì„œ íŠ¹íˆ ë›°ì–´ë‚œ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.
                                    ì˜ì–´ ê³¼ëª©ì˜ ë³´ì™„ì´ í•„ìš”í•˜ë©°, 1í•™ë…„ 2í•™ê¸°ë¶€í„° ì§‘ì¤‘ ê´€ë¦¬í•˜ë©´ ëª©í‘œ ë“±ê¸‰ ë‹¬ì„±ì´ ì¶©ë¶„íˆ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                                </div>
                            </div>
                        </div>

                        <!-- Section 3: í•™êµ ì •ë³´ê³µì‹œ ë°ì´í„° -->
                        <div class="section">
                            <h2 class="section-title">
                                <span class="section-icon">ğŸ«</span>
                                í•™êµ êµìœ¡ê³¼ì • ë¶„ì„
                            </h2>

                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th style="width: 25%;">í•­ëª©</th>
                                        <th>ë‚´ìš©</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>í•™êµ ìœ í˜•</strong></td>
                                        <td>ê³µë¦½ ì¼ë°˜ê³ ë“±í•™êµ</td>
                                    </tr>
                                    <tr>
                                        <td><strong>2024 ëŒ€í•™ì§„í•™ë¥ </strong></td>
                                        <td>92.3% (4ë…„ì œ 78.5%, ì „ë¬¸ëŒ€ 13.8%)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>ê°œì„¤ ì„ íƒê³¼ëª©</strong></td>
                                        <td>
                                            <span class="badge badge-primary">ì •ë³´</span>
                                            <span class="badge badge-primary">ì¸ê³µì§€ëŠ¥ê¸°ì´ˆ</span>
                                            <span class="badge badge-primary">ì‹¬í™”ìˆ˜í•™I</span>
                                            <span class="badge badge-primary">ë¯¸ì ë¶„</span>
                                            <span class="badge badge-primary">í™•ë¥ ê³¼í†µê³„</span>
                                            ì™¸ 18ê³¼ëª©
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>ìˆ˜í–‰í‰ê°€ ë¹„ì¤‘</strong></td>
                                        <td>ì •ë³´(40%), ìˆ˜í•™(30%), ê³¼í•™íƒêµ¬(35%), êµ­ì–´(25%)</td>
                                    </tr>
                                    <tr>
                                        <td><strong>í•™êµ íŠ¹ìƒ‰ì‚¬ì—…</strong></td>
                                        <td>SWÂ·AI ì¸ì¬ì–‘ì„± ì¤‘ì í•™êµ, ê³¼í•™ì¤‘ì ë°˜ ìš´ì˜, ìˆ˜í•™Â·ê³¼í•™ ì‹¬í™”ë°˜</td>
                                    </tr>
                                    <tr>
                                        <td><strong>êµë‚´ ê²½ì§„ëŒ€íšŒ</strong></td>
                                        <td>ì½”ë”©ê²½ì§„ëŒ€íšŒ(11ì›”), ìˆ˜í•™ê²½ì‹œëŒ€íšŒ(6ì›”), ê³¼í•™íƒêµ¬ëŒ€íšŒ(9ì›”)</td>
                                    </tr>
                                </tbody>
                            </table>

                            <div class="strategy-box">
                                <div class="strategy-title">ğŸ’¡ AI êµìœ¡ê³¼ì • ë¶„ì„ ê²°ê³¼</div>
                                <div class="strategy-content">
                                    ì„œìš¸ê³ ë“±í•™êµëŠ” <strong>SWÂ·AI ì¤‘ì í•™êµ</strong>ë¡œ ì§€ì •ë˜ì–´ ì»´í“¨í„°ê³µí•™ í¬ë§ìì—ê²Œ ìµœì í™”ëœ í™˜ê²½ì…ë‹ˆë‹¤.
                                    ì •ë³´ ê³¼ëª© ìˆ˜í–‰í‰ê°€ ë¹„ì¤‘ì´ <strong>40%</strong>ë¡œ ë§¤ìš° ë†’ì•„ ì„¸ë¶€ëŠ¥ë ¥íŠ¹ê¸°ì‚¬í•­(ì„¸íŠ¹) ì‘ì„±ì— ìœ ë¦¬í•˜ë©°,
                                    ì¸ê³µì§€ëŠ¥ê¸°ì´ˆ ê³¼ëª©ì´ ì •ê·œ êµìœ¡ê³¼ì •ì— í¸ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
                                    êµë‚´ <strong>ì½”ë”©ê²½ì§„ëŒ€íšŒ</strong>(ë§¤ë…„ 11ì›” ê°œìµœ)ëŠ” í•„ìˆ˜ ì°¸ê°€ ê¶Œì¥ í™œë™ì…ë‹ˆë‹¤.
                                </div>
                            </div>
                        </div>

                        <!-- Section 3: ëŒ€í•™ ì¶”ì²œ -->
                        <div class="section">
                            <h2 class="section-title">
                                <span class="section-icon">ğŸ¯</span>
                                ì»´í“¨í„°ê³µí•™ê³¼ ë§ì¶¤ ëŒ€í•™ ì¶”ì²œ
                            </h2>

                            <div class="university-tiers">
                                <div class="tier-box">
                                    <div class="tier-header">
                                        <div class="tier-title">
                                            <span class="badge badge-danger">ğŸ”¥ ë„ì „ ëŒ€í•™</span>
                                            <span style="font-size: 0.85em; color: #666;">ë‚´ì‹  1.5ë“±ê¸‰ ì´ë‚´</span>
                                        </div>
                                    </div>
                                    <div class="tier-universities">
                                        <div class="university-chip">ì„œìš¸ëŒ€ ì»´í“¨í„°ê³µí•™ë¶€</div>
                                        <div class="university-chip">ì¹´ì´ìŠ¤íŠ¸ ì „ì‚°í•™ë¶€</div>
                                        <div class="university-chip">ì—°ì„¸ëŒ€ ì»´í“¨í„°ê³¼í•™ê³¼</div>
                                        <div class="university-chip">ê³ ë ¤ëŒ€ ì»´í“¨í„°í•™ê³¼</div>
                                        <div class="university-chip">í¬ìŠ¤í… ì»´í“¨í„°ê³µí•™ê³¼</div>
                                    </div>
                                </div>

                                <div class="tier-box">
                                    <div class="tier-header">
                                        <div class="tier-title">
                                            <span class="badge badge-warning">ğŸ¯ ì ì • ëŒ€í•™</span>
                                            <span style="font-size: 0.85em; color: #666;">ë‚´ì‹  2.5ë“±ê¸‰ ì´ë‚´</span>
                                        </div>
                                    </div>
                                    <div class="tier-universities">
                                        <div class="university-chip">ì„±ê· ê´€ëŒ€ ì†Œí”„íŠ¸ì›¨ì–´í•™ê³¼</div>
                                        <div class="university-chip">í•œì–‘ëŒ€ ì»´í“¨í„°ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€</div>
                                        <div class="university-chip">ì¤‘ì•™ëŒ€ AIí•™ê³¼</div>
                                        <div class="university-chip">ê²½í¬ëŒ€ ì»´í“¨í„°ê³µí•™ê³¼</div>
                                        <div class="university-chip">ì„œê°•ëŒ€ ì»´í“¨í„°ê³µí•™ê³¼</div>
                                    </div>
                                </div>

                                <div class="tier-box">
                                    <div class="tier-header">
                                        <div class="tier-title">
                                            <span class="badge badge-success">âœ… ì•ˆì • ëŒ€í•™</span>
                                            <span style="font-size: 0.85em; color: #666;">ë‚´ì‹  3.5ë“±ê¸‰ ì´ë‚´</span>
                                        </div>
                                    </div>
                                    <div class="tier-universities">
                                        <div class="university-chip">ë™êµ­ëŒ€ ì»´í“¨í„°ê³µí•™ê³¼</div>
                                        <div class="university-chip">ìˆ­ì‹¤ëŒ€ ì»´í“¨í„°í•™ë¶€</div>
                                        <div class="university-chip">ì„¸ì¢…ëŒ€ ì†Œí”„íŠ¸ì›¨ì–´í•™ê³¼</div>
                                        <div class="university-chip">ê´‘ìš´ëŒ€ ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€</div>
                                        <div class="university-chip">ì•„ì£¼ëŒ€ ì†Œí”„íŠ¸ì›¨ì–´í•™ê³¼</div>
                                    </div>
                                </div>
                            </div>

                            <table class="data-table" style="margin-top: 30px;">
                                <thead>
                                    <tr>
                                        <th>ì „í˜• ìœ í˜•</th>
                                        <th>í•µì‹¬ ì „ëµ</th>
                                        <th>ì¤€ë¹„ì‚¬í•­</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>í•™ìƒë¶€ì¢…í•©</strong></td>
                                        <td>ì •ë³´Â·ìˆ˜í•™ ì„¸íŠ¹ ê°•í™”</td>
                                        <td>êµë‚´ ì½”ë”©ëŒ€íšŒ ìˆ˜ìƒ, AI í”„ë¡œì íŠ¸ ë™ì•„ë¦¬, í”„ë¡œê·¸ë˜ë° ì†Œë…¼ë¬¸</td>
                                    </tr>
                                    <tr>
                                        <td><strong>í•™ìƒë¶€êµê³¼</strong></td>
                                        <td>ë‚´ì‹  1-2ë“±ê¸‰ ìœ ì§€</td>
                                        <td>ìˆ˜í•™Â·ê³¼í•™ ì§‘ì¤‘ ê´€ë¦¬, ì •ë³´ ê³¼ëª© ë§Œì  ëª©í‘œ</td>
                                    </tr>
                                    <tr>
                                        <td><strong>ë…¼ìˆ </strong></td>
                                        <td>ìˆ˜ë¦¬ë…¼ìˆ  ëŒ€ë¹„</td>
                                        <td>ë¯¸ì ë¶„Â·í™•ë¥ í†µê³„ ì‹¬í™”, ë…¼ìˆ  í•™ì› ë³‘í–‰</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Section 5: 3ê°œë…„ ë¡œë“œë§µ ë° í™œë™ ì°¨íŠ¸ -->
                        <div class="section">
                            <h2 class="section-title">
                                <span class="section-icon">ğŸ“…</span>
                                3ê°œë…„ í™œë™ ë¡œë“œë§µ ë° ë¶„ì„
                            </h2>

                            <!-- í™œë™ íƒ€ì„ë¼ì¸ ì°¨íŠ¸ -->
                            <div class="chart-container">
                                <h3 class="chart-title">3ê°œë…„ í™œë™ ê³„íš íƒ€ì„ë¼ì¸</h3>
                                <div class="chart-wrapper full-width" style="height: 400px;">
                                    <canvas id="timelineChart"></canvas>
                                </div>
                            </div>

                            <!-- í•™êµ êµìœ¡ê³¼ì • ë¶„ì„ ì°¨íŠ¸ -->
                            <div class="charts-grid">
                                <div class="chart-container">
                                    <h3 class="chart-title">í•™ë…„ë³„ í™œë™ ë¹„ì¤‘ ë¶„ì„</h3>
                                    <div class="chart-wrapper">
                                        <canvas id="activityBarChart"></canvas>
                                    </div>
                                </div>
                                <div class="chart-container">
                                    <h3 class="chart-title">êµìœ¡ê³¼ì • ì´ìˆ˜ ê³„íš</h3>
                                    <div class="chart-wrapper">
                                        <canvas id="curriculumChart"></canvas>
                                    </div>
                                </div>
                            </div>

                            <div class="mindmap-container">
                                <!-- 1í•™ë…„ -->
                                <div class="mindmap-year">
                                    <div class="year-node">1</div>
                                    <div class="year-header-title">ê³ ë“±í•™êµ 1í•™ë…„ - ê¸°ì´ˆ íƒìƒ‰ ë‹¨ê³„</div>

                                    <div class="semester-boxes">
                                        <div class="semester-box">
                                            <div class="semester-title">ğŸ“– 1í•™ê¸°</div>
                                            <div class="activity-items">
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-success">ë™ì•„ë¦¬</span>
                                                    </div>
                                                    <div class="activity-text">í”„ë¡œê·¸ë˜ë° ë™ì•„ë¦¬ ê°€ì… ë° Python ê¸°ì´ˆ í•™ìŠµ</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-warning">ë…ì„œ</span>
                                                    </div>
                                                    <div class="activity-text">"í—¬ë¡œ ì½”ë”©", "ì»´í“¨í„° ê³¼í•™ì´ ì—¬ëŠ” ì„¸ê³„" ë…ì„œë¡ ì‘ì„±</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-info">ìˆ˜í–‰í‰ê°€</span>
                                                        <span class="badge badge-success">í•™êµ DB</span>
                                                    </div>
                                                    <div class="activity-text">[ì •ë³´ 40%] ê³„ì‚°ê¸° í”„ë¡œê·¸ë¨ ì œì‘ í”„ë¡œì íŠ¸</div>
                                                    <div class="activity-note">â†’ ì„œìš¸ê³  1í•™ë…„ ì •ë³´ ìˆ˜í–‰í‰ê°€ ì‹¤ì œ ì£¼ì œ</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="semester-box">
                                            <div class="semester-title">ğŸ“– 2í•™ê¸°</div>
                                            <div class="activity-items">
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-success">ë™ì•„ë¦¬</span>
                                                    </div>
                                                    <div class="activity-text">ì•Œê³ ë¦¬ì¦˜ ìŠ¤í„°ë”” ê·¸ë£¹ ìš´ì˜ ë° ê¸°ì´ˆ ë¬¸ì œ í•´ê²°</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-danger">íƒêµ¬</span>
                                                    </div>
                                                    <div class="activity-text">ì •ë ¬ ì•Œê³ ë¦¬ì¦˜ ë¹„êµ ë¶„ì„ ì†Œë…¼ë¬¸ (ë²„ë¸”ì •ë ¬ vs í€µì •ë ¬)</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-primary">ëŒ€íšŒ</span>
                                                        <span class="badge badge-success">í•™êµ DB</span>
                                                    </div>
                                                    <div class="activity-text">êµë‚´ ì½”ë”©ê²½ì§„ëŒ€íšŒ ì°¸ê°€ ë° ì…ìƒ ëª©í‘œ</div>
                                                    <div class="activity-note">â†’ ë§¤ë…„ 11ì›” ê°œìµœ (í•™êµì•Œë¦¬ë¯¸ í™•ì¸)</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 2í•™ë…„ -->
                                <div class="mindmap-year">
                                    <div class="year-node">2</div>
                                    <div class="year-header-title">ê³ ë“±í•™êµ 2í•™ë…„ - ì‹¬í™” íƒêµ¬ ë‹¨ê³„</div>

                                    <div class="semester-boxes">
                                        <div class="semester-box">
                                            <div class="semester-title">ğŸ“– 1í•™ê¸°</div>
                                            <div class="activity-items">
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-success">ë™ì•„ë¦¬</span>
                                                    </div>
                                                    <div class="activity-text">AI í”„ë¡œì íŠ¸ ë™ì•„ë¦¬ ë¶€ì¥, ë¨¸ì‹ ëŸ¬ë‹ ê¸°ì´ˆ ìŠ¤í„°ë”” ì§„í–‰</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-info">ìˆ˜í–‰í‰ê°€</span>
                                                        <span class="badge badge-success">í•™êµ DB</span>
                                                    </div>
                                                    <div class="activity-text">[ì¸ê³µì§€ëŠ¥ê¸°ì´ˆ] ì„ í˜•íšŒê·€ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ í”„ë¡œì íŠ¸</div>
                                                    <div class="activity-note">â†’ ì„œìš¸ê³  2í•™ë…„ ì„ íƒê³¼ëª© (ê°œì„¤ í™•ì¸ë¨)</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-danger">íƒêµ¬</span>
                                                    </div>
                                                    <div class="activity-text">í•™ìƒ ì„±ì  ì˜ˆì¸¡ AI ëª¨ë¸ ê°œë°œ ë° ì •í™•ë„ ê°œì„  ì—°êµ¬</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="semester-box">
                                            <div class="semester-title">ğŸ“– 2í•™ê¸°</div>
                                            <div class="activity-items">
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-info">ìˆ˜í–‰í‰ê°€</span>
                                                        <span class="badge badge-success">í•™êµ DB</span>
                                                    </div>
                                                    <div class="activity-text">[ì‹¬í™”ìˆ˜í•™I] ê²½ì‚¬í•˜ê°•ë²• ì›ë¦¬ íƒêµ¬ ë°œí‘œ</div>
                                                    <div class="activity-note">â†’ ë¯¸ì ë¶„ê³¼ AI ì•Œê³ ë¦¬ì¦˜ ìœµí•©</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-danger">íƒêµ¬</span>
                                                    </div>
                                                    <div class="activity-text">CNN ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ êµ¬í˜„ (CIFAR-10)</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-warning">ë…ì„œ</span>
                                                    </div>
                                                    <div class="activity-text">"ë°‘ë°”ë‹¥ë¶€í„° ì‹œì‘í•˜ëŠ” ë”¥ëŸ¬ë‹" ì‹¬í™” ë…ì„œ</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 3í•™ë…„ -->
                                <div class="mindmap-year">
                                    <div class="year-node">3</div>
                                    <div class="year-header-title">ê³ ë“±í•™êµ 3í•™ë…„ - í†µí•© ì‹¬í™” ë‹¨ê³„</div>

                                    <div class="semester-boxes">
                                        <div class="semester-box">
                                            <div class="semester-title">ğŸ“– 1í•™ê¸°</div>
                                            <div class="activity-items">
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-danger">ì¢…í•©íƒêµ¬</span>
                                                    </div>
                                                    <div class="activity-text">NLP ê¸°ë°˜ ê°ì •ë¶„ì„ ì±—ë´‡ ê°œë°œ í”„ë¡œì íŠ¸</div>
                                                    <div class="activity-note">â†’ 3ë…„ê°„ í•™ìŠµ ì§‘ëŒ€ì„±</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-success">ë©˜í† ë§</span>
                                                    </div>
                                                    <div class="activity-text">í›„ë°° ëŒ€ìƒ Python ê¸°ì´ˆë°˜ ê°•ì˜ ë° í”„ë¡œì íŠ¸ ì§€ë„</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-primary">ëŒ€íšŒ</span>
                                                        <span class="badge badge-success">í•™êµ DB</span>
                                                    </div>
                                                    <div class="activity-text">êµë‚´ ê³¼í•™íƒêµ¬ëŒ€íšŒ ìµœìš°ìˆ˜ìƒ ëª©í‘œ (AI ìœ¤ë¦¬)</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="semester-box">
                                            <div class="semester-title">ğŸ“– 2í•™ê¸° (ìˆ˜ì‹œ ì¤€ë¹„)</div>
                                            <div class="activity-items">
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-primary">ë´‰ì‚¬</span>
                                                    </div>
                                                    <div class="activity-text">ì§€ì—­ì•„ë™ì„¼í„° ì½”ë”©êµìœ¡ ë´‰ì‚¬ (ì´ˆë“± ìŠ¤í¬ë˜ì¹˜)</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-warning">ë…ì„œ</span>
                                                    </div>
                                                    <div class="activity-text">"í´ë¦°ì½”ë“œ", "ì†Œí”„íŠ¸ì›¨ì–´ ì¥ì¸" ì „ê³µ ì‹¬í™”</div>
                                                </div>
                                                <div class="activity-box">
                                                    <div class="activity-header">
                                                        <span class="badge badge-primary">ì§„ë¡œ</span>
                                                    </div>
                                                    <div class="activity-text">AI ìœ¤ë¦¬ ì„¸ë¯¸ë‚˜ ì°¸ì—¬ ë° ì—ì„¸ì´ ì‘ì„±</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 6: ì…ì‹œì „ëµ ìš”ì•½ -->
                        <div class="section">
                            <h2 class="section-title">
                                <span class="section-icon">âœ…</span>
                                í•™êµ ë§ì¶¤ ì…ì‹œì „ëµ ì²´í¬ë¦¬ìŠ¤íŠ¸
                            </h2>

                            <div class="strategy-box">
                                <div class="strategy-title">ğŸ¯ ë°˜ë“œì‹œ ì±™ê²¨ì•¼ í•  í™œë™ (í•™êµ DB ê¸°ë°˜)</div>
                                <ul class="strategy-list">
                                    <li><strong>1í•™ë…„ 11ì›”:</strong> êµë‚´ ì½”ë”©ê²½ì§„ëŒ€íšŒ ì°¸ê°€ í•„ìˆ˜ (í•™êµ ì •ê¸° í–‰ì‚¬)</li>
                                    <li><strong>2í•™ë…„:</strong> ì¸ê³µì§€ëŠ¥ê¸°ì´ˆ ì„ íƒê³¼ëª© ìˆ˜ê°• ê¶Œì¥ (í•™êµ ê°œì„¤ í™•ì¸)</li>
                                    <li><strong>ì •ë³´ ìˆ˜í–‰í‰ê°€:</strong> ë§¤ í•™ê¸° 40% ë¹„ì¤‘ â†’ ì„¸íŠ¹ ì§‘ì¤‘ ê´€ë¦¬</li>
                                    <li><strong>ìˆ˜í•™Â·ê³¼í•™ ë‚´ì‹ :</strong> 1-2ë“±ê¸‰ ìœ ì§€ ëª©í‘œ (ì„œìš¸ê³  ì§„í•™ë¥  ê³ ë ¤)</li>
                                    <li><strong>ë™ì•„ë¦¬ í™œë™:</strong> AI/í”„ë¡œê·¸ë˜ë° ê´€ë ¨ ë™ì•„ë¦¬ 3ë…„ ì§€ì†</li>
                                </ul>
                            </div>

                            <table class="data-table" style="margin-top: 25px;">
                                <thead>
                                    <tr>
                                        <th>ë‚´ì‹  ë“±ê¸‰</th>
                                        <th>ìœ„ í™œë™ ì´í–‰ ì‹œ</th>
                                        <th>ì˜ˆìƒ í•©ê²© ëŒ€í•™</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>1.5ë“±ê¸‰ ì´ë‚´</strong></td>
                                        <td>ëª¨ë“  í™œë™ ì™„ë£Œ</td>
                                        <td><span class="badge badge-danger">ì—°ì„¸ëŒ€Â·ê³ ë ¤ëŒ€ ì»´í“¨í„°ê³µí•™ê³¼ í•©ê²©ê¶Œ</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>2.0ë“±ê¸‰ ì´ë‚´</strong></td>
                                        <td>ëª¨ë“  í™œë™ ì™„ë£Œ</td>
                                        <td><span class="badge badge-warning">ì„±ê· ê´€ëŒ€Â·í•œì–‘ëŒ€ ì†Œí”„íŠ¸ì›¨ì–´ í•©ê²©ê¶Œ</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>2.5ë“±ê¸‰ ì´ë‚´</strong></td>
                                        <td>ì£¼ìš” í™œë™ ì™„ë£Œ</td>
                                        <td><span class="badge badge-success">ì¤‘ì•™ëŒ€Â·ê²½í¬ëŒ€ ì»´í“¨í„°ê³µí•™ê³¼ í•©ê²©ê¶Œ</span></td>
                                    </tr>
                                </tbody>
                            </table>

                            <p style="margin-top: 15px; color: #666; font-size: 0.9em; font-style: italic;">
                                * 2024í•™ë…„ë„ ì„œìš¸ê³ ë“±í•™êµ ì»´í“¨í„°ê³µí•™ê³¼ í•©ê²©ì í‰ê·  ë°ì´í„° ê¸°ë°˜ ë¶„ì„
                            </p>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ (ëª¨ë‹¬ ì—´ë ¸ì„ ë•Œ í‘œì‹œ) -->
    <button class="pdf-button" id="pdfButton" onclick="downloadPDF()">
        ğŸ“¥ PDF ë‹¤ìš´ë¡œë“œ
    </button>

    <script>
        // Chart.js ê¸°ë³¸ ì„¤ì •
        Chart.defaults.font.family = "'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif";

        // ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
        let charts = {};

        // ì „ì—­ ë³€ìˆ˜ë¡œ ìˆ˜ì§‘ëœ ë°ì´í„° ì €ì¥
        let studentData = {};
        let schoolDetailData = {};

        // ë“±ê¸‰-ì ìˆ˜ ë³€í™˜ í•¨ìˆ˜
        function gradeToScore(grade) {
            const gradeMap = {
                '1': 95, '2': 90, '3': 85, '4': 80,
                '5': 75, '6': 70, '7': 65, '8': 60, '9': 55
            };
            return gradeMap[grade] || 0;
        }

        // í‰ê·  ë“±ê¸‰ ê³„ì‚° í•¨ìˆ˜
        function calculateAvgGrade(grades) {
            const validGrades = grades.filter(g => g > 0 && g <= 9);
            if (validGrades.length === 0) return 0;
            const sum = validGrades.reduce((a, b) => parseFloat(a) + parseFloat(b), 0);
            return (sum / validGrades.length).toFixed(1);
        }

        // ë°ì´í„° ìˆ˜ì§‘ í•¨ìˆ˜
        function collectAllData() {
            const data = {
                // ê¸°ë³¸ ì •ë³´
                name: document.getElementById('studentName').value || 'í•™ìƒ',
                grade: document.getElementById('currentGrade').value,
                schoolName: document.getElementById('schoolName').value || 'í•™êµ',

                // í¬ë§ ì§„ë¡œ
                major: document.getElementById('major').value,
                department: document.getElementById('department').value || 'ë¯¸ì •',
                keywords: document.getElementById('keywords').value,

                // ì„±ì  ì •ë³´
                grades: {
                    korean: document.getElementById('gradeKorean').value,
                    english: document.getElementById('gradeEnglish').value,
                    math: document.getElementById('gradeMath').value
                },

                // ì¶”ê°€ ê³¼ëª© ì •ë³´
                additionalSubjects: [],

                // í™œë™ ì •ë³´
                activities: {
                    club: parseInt(document.getElementById('activityClub').value) || 0,
                    award: parseInt(document.getElementById('activityAward').value) || 0,
                    project: parseInt(document.getElementById('activityProject').value) || 0,
                    details: document.getElementById('activityDetails').value
                },

                // ëª©í‘œ
                targets: {
                    univ1: document.getElementById('targetUniv1').value || 'ë¯¸ì •',
                    univ2: document.getElementById('targetUniv2').value || 'ë¯¸ì •',
                    univ3: document.getElementById('targetUniv3').value || '',
                    univ4: document.getElementById('targetUniv4').value || ''
                },

                // ê°•ì 
                strengths: document.getElementById('strengths').value
            };

            // ì¶”ê°€ ê³¼ëª© ìˆ˜ì§‘
            for (let i = 1; i <= additionalSubjectCount; i++) {
                const nameEl = document.getElementById(`subjectName${i}`);
                const gradeEl = document.getElementById(`subjectGrade${i}`);

                if (nameEl && gradeEl && nameEl.value && gradeEl.value) {
                    data.additionalSubjects.push({
                        name: nameEl.value,
                        grade: gradeEl.value
                    });
                }
            }

            // í‰ê·  ë“±ê¸‰ ê³„ì‚° (í•„ìˆ˜ ê³¼ëª© + ì¶”ê°€ ê³¼ëª©)
            const gradeValues = Object.values(data.grades).filter(g => g !== '').map(g => parseFloat(g));
            const additionalGradeValues = data.additionalSubjects.map(s => parseFloat(s.grade));
            const allGrades = [...gradeValues, ...additionalGradeValues];
            data.avgGrade = calculateAvgGrade(allGrades);

            studentData = data;
            return data;
        }

        // ë°ì´í„° ê²€ì¦ í•¨ìˆ˜
        function validateData(data) {
            const errors = [];

            if (!data.name.trim()) errors.push('í•™ìƒ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
            if (!data.schoolName.trim()) errors.push('í•™êµëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');

            // êµ­ì˜ìˆ˜ í•„ìˆ˜ ì…ë ¥ í™•ì¸
            if (!data.grades.korean) errors.push('êµ­ì–´ ì„±ì ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
            if (!data.grades.english) errors.push('ì˜ì–´ ì„±ì ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
            if (!data.grades.math) errors.push('ìˆ˜í•™ ì„±ì ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');

            return errors;
        }

        // localStorage ì €ì¥
        function saveToLocalStorage(data) {
            try {
                localStorage.setItem('studycareRoadmapData', JSON.stringify(data));
                localStorage.setItem('studycareRoadmapDate', new Date().toISOString());
            } catch (e) {
                console.error('ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', e);
            }
        }

        // localStorage ë¶ˆëŸ¬ì˜¤ê¸°
        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('studycareRoadmapData');
                const savedDate = localStorage.getItem('studycareRoadmapDate');

                if (savedData && savedDate) {
                    const data = JSON.parse(savedData);
                    const date = new Date(savedDate);
                    const daysDiff = (new Date() - date) / (1000 * 60 * 60 * 24);

                    // 7ì¼ ì´ë‚´ì˜ ë°ì´í„°ë§Œ ë¶ˆëŸ¬ì˜¤ê¸°
                    if (daysDiff < 7) {
                        const confirmLoad = confirm(`${date.toLocaleDateString('ko-KR')}ì— ì €ì¥ëœ ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤.\në¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?`);
                        if (confirmLoad) {
                            try {
                                fillFormWithData(data);
                                return true;
                            } catch (fillError) {
                                console.error('ë°ì´í„° ì±„ìš°ê¸° ì‹¤íŒ¨:', fillError);
                                // ì˜ëª»ëœ ë°ì´í„° ì‚­ì œ
                                localStorage.removeItem('studentRoadmapData');
                                alert('ì €ì¥ëœ ë°ì´í„° í˜•ì‹ì´ ë§ì§€ ì•Šì•„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                            }
                        }
                    } else {
                        // 7ì¼ ì´ìƒ ëœ ë°ì´í„° ìë™ ì‚­ì œ
                        localStorage.removeItem('studentRoadmapData');
                    }
                }
            } catch (e) {
                console.error('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', e);
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ localStorage ì´ˆê¸°í™”
                localStorage.removeItem('studentRoadmapData');
            }
            return false;
        }

        // í¼ì— ë°ì´í„° ì±„ìš°ê¸°
        function fillFormWithData(data) {
            const nameEl = document.getElementById('studentName');
            const gradeEl = document.getElementById('currentGrade');
            const schoolEl = document.getElementById('schoolName');
            const majorEl = document.getElementById('major');
            const deptEl = document.getElementById('department');
            const keywordsEl = document.getElementById('keywords');

            if (nameEl) nameEl.value = data.name || '';
            if (gradeEl) gradeEl.value = data.grade || '1';
            if (schoolEl) schoolEl.value = data.schoolName || '';
            if (majorEl) majorEl.value = data.major || 'ìì—°ê³„ì—´';
            if (deptEl) deptEl.value = data.department || '';
            if (keywordsEl) keywordsEl.value = data.keywords || '';

            // ì„±ì  ì •ë³´
            if (data.grades) {
                const koreanEl = document.getElementById('gradeKorean');
                const englishEl = document.getElementById('gradeEnglish');
                const mathEl = document.getElementById('gradeMath');
                const scienceEl = document.getElementById('gradeScience');
                const socialEl = document.getElementById('gradeSocial');
                const infoEl = document.getElementById('gradeInfo');

                if (koreanEl) koreanEl.value = data.grades.korean || '';
                if (englishEl) englishEl.value = data.grades.english || '';
                if (mathEl) mathEl.value = data.grades.math || '';
                if (scienceEl) scienceEl.value = data.grades.science || '';
                if (socialEl) socialEl.value = data.grades.social || '';
                if (infoEl) infoEl.value = data.grades.info || '';
            }

            // í™œë™ ì •ë³´
            if (data.activities) {
                const clubEl = document.getElementById('activityClub');
                const awardEl = document.getElementById('activityAward');
                const projectEl = document.getElementById('activityProject');
                const detailsEl = document.getElementById('activityDetails');

                if (clubEl) clubEl.value = data.activities.club || 0;
                if (awardEl) awardEl.value = data.activities.award || 0;
                if (projectEl) projectEl.value = data.activities.project || 0;
                if (detailsEl) detailsEl.value = data.activities.details || '';
            }

            // ëª©í‘œ
            if (data.targets) {
                const univ1El = document.getElementById('targetUniv1');
                const univ2El = document.getElementById('targetUniv2');
                const univ3El = document.getElementById('targetUniv3');
                const univ4El = document.getElementById('targetUniv4');

                if (univ1El) univ1El.value = data.targets.univ1 || '';
                if (univ2El) univ2El.value = data.targets.univ2 || '';
                if (univ3El) univ3El.value = data.targets.univ3 || '';
                if (univ4El) univ4El.value = data.targets.univ4 || '';
            }

            const strengthsEl = document.getElementById('strengths');
            if (strengthsEl) strengthsEl.value = data.strengths || '';
        }

        // ëª¨ë‹¬ì°½ ì—´ê¸°
        window.openModal = function() {
            document.getElementById('reportModal').classList.add('active');
            document.getElementById('pdfButton').classList.add('show');
            document.body.style.overflow = 'hidden';

            // ì°¨íŠ¸ ìƒì„± (ì²˜ìŒ ì—´ ë•Œë§Œ)
            if (!charts.gradeRadar) {
                setTimeout(() => {
                    createCharts();
                }, 100);
            }
        }

        // ëª¨ë‹¬ì°½ ë‹«ê¸°
        window.closeModal = function() {
            document.getElementById('reportModal').classList.remove('active');
            document.getElementById('pdfButton').classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('reportModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('reportModal')) {
                closeModal();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ë°ì´í„° í™•ì¸
        window.addEventListener('DOMContentLoaded', () => {
            loadFromLocalStorage();
        });

        // ì°¨íŠ¸ ìƒì„± í•¨ìˆ˜
        function createCharts() {
            // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìˆ˜ì§‘
            if (!studentData.grades) {
                collectAllData();
            }

            // 1. ê³¼ëª©ë³„ ì„±ì  ë ˆì´ë” ì°¨íŠ¸ - ì‹¤ì œ ì…ë ¥ ë°ì´í„° ì‚¬ìš©
            const currentScores = [
                gradeToScore(studentData.grades.korean || '5'),
                gradeToScore(studentData.grades.english || '5'),
                gradeToScore(studentData.grades.math || '5'),
                gradeToScore(studentData.grades.science || '5'),
                gradeToScore(studentData.grades.info || '5'),
                gradeToScore(studentData.grades.social || '5')
            ];

            // ëª©í‘œ ì„±ì  ê³„ì‚° (í˜„ì¬ ì„±ì ë³´ë‹¤ 1~2ë“±ê¸‰ ë†’ê²Œ ì„¤ì •)
            const targetScores = currentScores.map(score => Math.min(score + 10, 95));

            const gradeRadarCtx = document.getElementById('gradeRadarChart').getContext('2d');
            charts.gradeRadar = new Chart(gradeRadarCtx, {
                type: 'radar',
                data: {
                    labels: ['êµ­ì–´', 'ì˜ì–´', 'ìˆ˜í•™', 'ê³¼í•™', 'ì •ë³´', 'ì‚¬íšŒ'],
                    datasets: [{
                        label: 'í˜„ì¬ ì„±ì ',
                        data: currentScores,
                        borderColor: '#ca8a04',
                        backgroundColor: 'rgba(202, 138, 4, 0.2)',
                        borderWidth: 2,
                        pointBackgroundColor: '#ca8a04',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#ca8a04'
                    }, {
                        label: 'ëª©í‘œ ì„±ì ',
                        data: targetScores,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        borderWidth: 2,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#10b981'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.r + 'ì ';
                                }
                            }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        }
                    }
                }
            });

            // 2. ëŒ€í•™ë³„ í•©ê²© ê°€ëŠ¥ì„± ë„ë„› ì°¨íŠ¸ - í‰ê·  ë“±ê¸‰ ê¸°ë°˜ ê³„ì‚°
            const avgGrade = parseFloat(studentData.avgGrade) || 3.0;
            let possibilityData = [10, 30, 40, 20]; // ê¸°ë³¸ê°’

            // ë“±ê¸‰ì— ë”°ë¥¸ í•©ê²© ê°€ëŠ¥ì„± ê³„ì‚°
            if (avgGrade <= 1.5) {
                possibilityData = [35, 40, 20, 5]; // ìµœìƒìœ„ê¶Œ
            } else if (avgGrade <= 2.0) {
                possibilityData = [25, 35, 35, 5]; // ìƒìœ„ê¶Œ
            } else if (avgGrade <= 2.5) {
                possibilityData = [15, 35, 40, 10]; // ì¤‘ìƒìœ„ê¶Œ
            } else if (avgGrade <= 3.0) {
                possibilityData = [10, 30, 45, 15]; // ì¤‘ìœ„ê¶Œ
            } else {
                possibilityData = [5, 20, 50, 25]; // ì¤‘í•˜ìœ„ê¶Œ
            }

            const universityDoughnutCtx = document.getElementById('universityDoughnutChart').getContext('2d');
            charts.universityDoughnut = new Chart(universityDoughnutCtx, {
                type: 'doughnut',
                data: {
                    labels: ['ë„ì „ëŒ€í•™', 'ì ì •ëŒ€í•™', 'ì•ˆì •ëŒ€í•™', 'ìµœì†Œì•ˆì „ëŒ€í•™'],
                    datasets: [{
                        label: 'í•©ê²© ê°€ëŠ¥ì„±',
                        data: possibilityData,
                        backgroundColor: [
                            '#ef4444',
                            '#f59e0b',
                            '#10b981',
                            '#06b6d4'
                        ],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });

            // 3. 3ê°œë…„ í™œë™ íƒ€ì„ë¼ì¸ ì°¨íŠ¸ - ì…ë ¥ ë°ì´í„° ê¸°ë°˜ ìƒì„±
            const currentGrade = parseInt(studentData.grade) || 1;
            const activities = studentData.activities;

            // í˜„ì¬ í•™ë…„ì— ë”°ë¼ ë°ì´í„° ìƒì„±
            let timelineData = {
                êµë‚´í™œë™: [],
                ë…ì„œí™œë™: [],
                ë´‰ì‚¬í™œë™: [],
                ì§„ë¡œíƒêµ¬: []
            };

            // í™œë™ ë°ì´í„° ë¶„ë°° (í•™ë…„ë³„ë¡œ ì¦ê°€í•˜ëŠ” íŒ¨í„´)
            for (let i = 0; i < 10; i++) {
                const semester = Math.floor(i / 4) + 1; // 1, 2, 3í•™ë…„
                const isCurrentOrPast = semester <= currentGrade;

                if (isCurrentOrPast) {
                    // ì‹¤ì œ í™œë™ ë°ì´í„° ë°˜ì˜
                    timelineData.êµë‚´í™œë™.push(Math.max(1, Math.floor(activities.award / 3) + Math.floor(Math.random() * 2)));
                    timelineData.ë…ì„œí™œë™.push(Math.max(1, 2 + Math.floor(Math.random() * 2)));
                    timelineData.ë´‰ì‚¬í™œë™.push(Math.max(1, Math.floor(activities.volunteer / 20) + 1));
                    timelineData.ì§„ë¡œíƒêµ¬.push(Math.max(1, Math.floor(activities.project / 2) + semester));
                } else {
                    // ë¯¸ë˜ ì˜ˆìƒ ë°ì´í„°
                    timelineData.êµë‚´í™œë™.push(3 + semester);
                    timelineData.ë…ì„œí™œë™.push(2 + Math.floor(semester / 2));
                    timelineData.ë´‰ì‚¬í™œë™.push(2);
                    timelineData.ì§„ë¡œíƒêµ¬.push(2 + semester);
                }
            }

            const timelineCtx = document.getElementById('timelineChart').getContext('2d');
            charts.timeline = new Chart(timelineCtx, {
                type: 'bar',
                data: {
                    labels: [
                        '1-1í•™ê¸°', '1-2í•™ê¸°', '1-ì—¬ë¦„', '1-ê²¨ìš¸',
                        '2-1í•™ê¸°', '2-2í•™ê¸°', '2-ì—¬ë¦„', '2-ê²¨ìš¸',
                        '3-1í•™ê¸°', '3-2í•™ê¸°'
                    ],
                    datasets: [{
                        label: 'êµë‚´í™œë™',
                        data: timelineData.êµë‚´í™œë™,
                        backgroundColor: '#ca8a04'
                    }, {
                        label: 'ë…ì„œí™œë™',
                        data: timelineData.ë…ì„œí™œë™,
                        backgroundColor: '#854d0e'
                    }, {
                        label: 'ë´‰ì‚¬í™œë™',
                        data: timelineData.ë´‰ì‚¬í™œë™,
                        backgroundColor: '#10b981'
                    }, {
                        label: 'ì§„ë¡œíƒêµ¬',
                        data: timelineData.ì§„ë¡œíƒêµ¬,
                        backgroundColor: '#06b6d4'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'í™œë™ ìˆ˜'
                            }
                        }
                    }
                }
            });

            // 4. í•™ë…„ë³„ í™œë™ ë¹„ì¤‘ ë¶„ì„ - ì…ë ¥ ë°ì´í„° ê¸°ë°˜
            const activityTotal = activities.club + activities.award + activities.project + (activities.volunteer / 10);

            // í™œë™ ë¹„ì¤‘ ê³„ì‚° (í•™ë…„ë³„ ì¶”ì²œ ë¹„ì¤‘)
            let grade1Data, grade2Data, grade3Data;

            if (currentGrade === 1) {
                // 1í•™ë…„: í˜„ì¬ í™œë™ ë¹„ì¤‘ ë°˜ì˜
                grade1Data = [
                    Math.round((activities.club / Math.max(activityTotal, 1)) * 100),
                    Math.round((activities.award / Math.max(activityTotal, 1)) * 100),
                    Math.round((activities.project / Math.max(activityTotal, 1)) * 100),
                    Math.round(((activities.volunteer / 10) / Math.max(activityTotal, 1)) * 100)
                ];
                // 2,3í•™ë…„ì€ ì¶”ì²œ ë¹„ì¤‘
                grade2Data = [30, 25, 25, 20];
                grade3Data = [20, 30, 35, 15];
            } else if (currentGrade === 2) {
                grade1Data = [30, 20, 15, 35]; // 1í•™ë…„ ê³¼ê±° ì˜ˆìƒ
                // 2í•™ë…„: í˜„ì¬ í™œë™ ë¹„ì¤‘ ë°˜ì˜
                grade2Data = [
                    Math.round((activities.club / Math.max(activityTotal, 1)) * 100),
                    Math.round((activities.award / Math.max(activityTotal, 1)) * 100),
                    Math.round((activities.project / Math.max(activityTotal, 1)) * 100),
                    Math.round(((activities.volunteer / 10) / Math.max(activityTotal, 1)) * 100)
                ];
                grade3Data = [20, 30, 40, 10]; // 3í•™ë…„ ì¶”ì²œ
            } else {
                grade1Data = [35, 15, 10, 40]; // 1í•™ë…„ ê³¼ê±°
                grade2Data = [30, 25, 20, 25]; // 2í•™ë…„ ê³¼ê±°
                // 3í•™ë…„: í˜„ì¬ í™œë™ ë¹„ì¤‘ ë°˜ì˜
                grade3Data = [
                    Math.round((activities.club / Math.max(activityTotal, 1)) * 100),
                    Math.round((activities.award / Math.max(activityTotal, 1)) * 100),
                    Math.round((activities.project / Math.max(activityTotal, 1)) * 100),
                    Math.round(((activities.volunteer / 10) / Math.max(activityTotal, 1)) * 100)
                ];
            }

            const activityBarCtx = document.getElementById('activityBarChart').getContext('2d');
            charts.activityBar = new Chart(activityBarCtx, {
                type: 'bar',
                data: {
                    labels: ['1í•™ë…„', '2í•™ë…„', '3í•™ë…„'],
                    datasets: [{
                        label: 'ë™ì•„ë¦¬',
                        data: [grade1Data[0], grade2Data[0], grade3Data[0]],
                        backgroundColor: '#ca8a04'
                    }, {
                        label: 'ëŒ€íšŒì°¸ê°€',
                        data: [grade1Data[1], grade2Data[1], grade3Data[1]],
                        backgroundColor: '#854d0e'
                    }, {
                        label: 'í”„ë¡œì íŠ¸',
                        data: [grade1Data[2], grade2Data[2], grade3Data[2]],
                        backgroundColor: '#10b981'
                    }, {
                        label: 'ë´‰ì‚¬í™œë™',
                        data: [grade1Data[3], grade2Data[3], grade3Data[3]],
                        backgroundColor: '#06b6d4'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 10,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'ë¹„ì¤‘ (%)'
                            }
                        }
                    }
                }
            });

            // 5. êµìœ¡ê³¼ì • ì´ìˆ˜ ê³„íš
            const curriculumCtx = document.getElementById('curriculumChart').getContext('2d');
            charts.curriculum = new Chart(curriculumCtx, {
                type: 'polarArea',
                data: {
                    labels: ['ìˆ˜í•™', 'ê³¼í•™', 'ì •ë³´', 'ì¸ë¬¸', 'ì˜ˆì²´ëŠ¥'],
                    datasets: [{
                        label: 'ì´ìˆ˜ ë‹¨ìœ„',
                        data: [30, 28, 24, 18, 10],
                        backgroundColor: [
                            'rgba(202, 138, 4, 0.8)',
                            'rgba(133, 77, 14, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(6, 182, 212, 0.8)',
                            'rgba(239, 68, 68, 0.8)'
                        ],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 10,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        // PDF ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
        window.downloadPDF = function() {
            const element = document.getElementById('reportContent');
            const studentName = document.getElementById('studentName').value || 'í•™ìƒ';
            const today = new Date().toISOString().split('T')[0];

            // PDF ì„¤ì •
            const opt = {
                margin: [10, 10, 10, 10],
                filename: `ìŠ¤í„°ë””ì¼€ì–´_ì…ì‹œì „ëµë¡œë“œë§µ_${studentName}_${today}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    letterRendering: true,
                    windowWidth: 1200
                },
                jsPDF: {
                    unit: 'mm',
                    format: 'a4',
                    orientation: 'portrait',
                    compress: true
                },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };

            // ë¡œë”© í‘œì‹œ
            const pdfButton = document.getElementById('pdfButton');
            const originalText = pdfButton.innerHTML;
            pdfButton.innerHTML = 'â³ PDF ìƒì„± ì¤‘...';
            pdfButton.disabled = true;

            // PDF ìƒì„±
            html2pdf().set(opt).from(element).save().then(() => {
                // ì™„ë£Œ í›„ ë²„íŠ¼ ë³µì›
                pdfButton.innerHTML = originalText;
                pdfButton.disabled = false;
            }).catch((error) => {
                console.error('PDF ìƒì„± ì˜¤ë¥˜:', error);
                alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                pdfButton.innerHTML = originalText;
                pdfButton.disabled = false;
            });
        }

        window.goToStep2 = async function() {
            // 1. ë°ì´í„° ìˆ˜ì§‘ ë° ê²€ì¦
            const data = collectAllData();
            const errors = validateData(data);

            if (errors.length > 0) {
                alert(errors.join('\n'));
                return;
            }

            // ë°ì´í„° ì €ì¥
            saveToLocalStorage(data);

            // ë¬¸ì„œ í—¤ë” ì •ë³´ ì—…ë°ì´íŠ¸
            const docName = document.getElementById('doc-name');
            const docGrade = document.getElementById('doc-grade');
            const docSchool = document.getElementById('doc-school');
            const docMajor = document.getElementById('doc-major');
            const docDept = document.getElementById('doc-dept');

            if (docName) docName.textContent = data.name;
            if (docGrade) docGrade.textContent = `ê³ ë“±í•™êµ ${data.grade}í•™ë…„`;
            if (docSchool) docSchool.textContent = data.schoolName;
            if (docMajor) docMajor.textContent = data.major;
            if (docDept) docDept.textContent = data.department;

            // ë‚ ì§œì™€ ë¬¸ì„œ ë²ˆí˜¸ ì„¤ì • (ìš”ì†Œê°€ ìˆëŠ” ê²½ìš°ë§Œ)
            const today = new Date();
            const docDate = document.getElementById('doc-date');
            const docNumber = document.getElementById('doc-number');

            if (docDate) docDate.textContent = today.toLocaleDateString('ko-KR');
            if (docNumber) docNumber.textContent = Math.floor(Math.random() * 10000).toString().padStart(4, '0');

            // ëª¨ë‹¬ ì—´ê¸°
            const reportModal = document.getElementById('reportModal');
            if (!reportModal) {
                console.error('reportModal ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            reportModal.classList.add('active');
            document.body.style.overflow = 'hidden';

            // ë¡œë”© ì˜¤ë²„ë ˆì´ë¥¼ ëª¨ë‹¬ ì½˜í…ì¸  ìœ„ì— ì¶”ê°€
            const modalContent = document.querySelector('.modal-content');
            if (!modalContent) {
                console.error('modal-content ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const loadingOverlay = document.createElement('div');
            loadingOverlay.className = 'loading-overlay';
            loadingOverlay.innerHTML = `
                <div class="loading-spinner"></div>
                <div class="loading-message">AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... âœ¨</div>
            `;
            modalContent.appendChild(loadingOverlay);

            // ì„ íƒí•œ í•™êµê°€ ìˆìœ¼ë©´ ì¶”ê°€ ì •ë³´ ìˆ˜ì§‘
            if (selectedSchoolCode) {
                await loadAdditionalSchoolData();
            }

            // AI ë¶„ì„ ë° ë³´ê³ ì„œ ìƒì„±
            setTimeout(() => {
                // AI ì¸ì‚¬ì´íŠ¸ ìƒì„±
                const insights = generateAIInsights(data);

                // ë§ì¶¤í˜• ë¡œë“œë§µ ìƒì„±
                const roadmap = generatePersonalizedRoadmap(data);

                // ë³´ê³ ì„œ ë‚´ìš© ë™ì  ì—…ë°ì´íŠ¸
                updateReportContent(data, insights, roadmap);

                // ë¡œë”© ì œê±°
                loadingOverlay.remove();
                const pdfButton = document.getElementById('pdfButton');
                if (pdfButton) pdfButton.classList.add('show');

                // ì°¨íŠ¸ ìƒì„±
                if (!charts.gradeRadar) {
                    setTimeout(() => {
                        createCharts();
                    }, 100);
                }
            }, 2000);
        }

        // AI ì¸ì‚¬ì´íŠ¸ ìƒì„± í•¨ìˆ˜ (ë£° ê¸°ë°˜)
        function generateAIInsights(data) {
            const insights = {
                grades: {
                    strong: [],
                    weak: [],
                    improvement: []
                },
                activities: {
                    strong: [],
                    lacking: [],
                    recommendations: []
                },
                overall: {
                    possibility: 0,
                    strengths: [],
                    challenges: []
                }
            };

            // ì„±ì  ë¶„ì„
            const gradeThreshold = 3; // 3ë“±ê¸‰ ê¸°ì¤€
            Object.entries(data.grades).forEach(([subject, grade]) => {
                if (grade && grade !== '') {
                    const gradeNum = parseFloat(grade);
                    const subjectNames = {
                        korean: 'êµ­ì–´', english: 'ì˜ì–´', math: 'ìˆ˜í•™',
                        science: 'ê³¼í•™', social: 'ì‚¬íšŒ', info: 'ì •ë³´'
                    };

                    if (gradeNum <= 2) {
                        insights.grades.strong.push(`${subjectNames[subject]} (${grade}ë“±ê¸‰)`);
                    } else if (gradeNum >= 4) {
                        insights.grades.weak.push(`${subjectNames[subject]} (${grade}ë“±ê¸‰)`);
                        insights.grades.improvement.push(`${subjectNames[subject]} ì„±ì  í–¥ìƒ í•„ìš”`);
                    }
                }
            });

            // í™œë™ ë¶„ì„
            const activities = data.activities;
            const totalActivities = activities.club + activities.award + activities.project;

            if (activities.club >= 2) {
                insights.activities.strong.push('ë™ì•„ë¦¬ í™œë™ í™œë°œ');
            } else {
                insights.activities.lacking.push('ë™ì•„ë¦¬ í™œë™ ë¶€ì¡±');
            }

            if (activities.award >= 3) {
                insights.activities.strong.push('êµë‚´ ëŒ€íšŒ ì°¸ê°€ ìš°ìˆ˜');
            } else {
                insights.activities.lacking.push('êµë‚´ ëŒ€íšŒ ì°¸ê°€ í•„ìš”');
            }

            if (activities.volunteer >= 20) {
                insights.activities.strong.push('ë´‰ì‚¬í™œë™ ì‹œê°„ ì¶©ë¶„');
            } else {
                insights.activities.lacking.push(`ë´‰ì‚¬í™œë™ ì‹œê°„ ë³´ì¶© í•„ìš” (í˜„ì¬ ${activities.volunteer}ì‹œê°„)`);
            }

            // í¬ë§ í•™ê³¼ë³„ ì¶”ì²œ í™œë™
            if (data.department.includes('ì»´í“¨í„°') || data.department.includes('ì†Œí”„íŠ¸ì›¨ì–´')) {
                insights.activities.recommendations.push('í”„ë¡œê·¸ë˜ë° ë™ì•„ë¦¬ í™œë™ ê¶Œì¥');
                insights.activities.recommendations.push('ì½”ë”© ëŒ€íšŒ ì°¸ê°€ ì¶”ì²œ');
                insights.activities.recommendations.push('ì•±/ì›¹ ê°œë°œ í”„ë¡œì íŠ¸ ìˆ˜í–‰');
            } else if (data.department.includes('ì˜') || data.department.includes('ì•½')) {
                insights.activities.recommendations.push('ìƒëª…ê³¼í•™ ë™ì•„ë¦¬ í™œë™');
                insights.activities.recommendations.push('ì˜ë£Œë´‰ì‚¬ í™œë™ ì°¸ì—¬');
                insights.activities.recommendations.push('ê³¼í•™ ì‹¤í—˜ í”„ë¡œì íŠ¸ ìˆ˜í–‰');
            }

            // ì „ì²´ ê°€ëŠ¥ì„± ê³„ì‚°
            const avgGrade = parseFloat(data.avgGrade) || 3.0;
            if (avgGrade <= 1.5) {
                insights.overall.possibility = 90;
                insights.overall.strengths.push('ìµœìƒìœ„ê¶Œ ì„±ì  ìœ ì§€');
            } else if (avgGrade <= 2.0) {
                insights.overall.possibility = 75;
                insights.overall.strengths.push('ìƒìœ„ê¶Œ ì„±ì  ìœ ì§€');
            } else if (avgGrade <= 2.5) {
                insights.overall.possibility = 60;
                insights.overall.challenges.push('ì£¼ìš” ê³¼ëª© ì„±ì  í–¥ìƒ í•„ìš”');
            } else if (avgGrade <= 3.0) {
                insights.overall.possibility = 45;
                insights.overall.challenges.push('ì „ë°˜ì ì¸ ì„±ì  í–¥ìƒ í•„ìš”');
            } else {
                insights.overall.possibility = 30;
                insights.overall.challenges.push('ì§‘ì¤‘ì ì¸ í•™ìŠµ ì „ëµ ìˆ˜ë¦½ í•„ìš”');
            }

            return insights;
        }

        // ë§ì¶¤í˜• ë¡œë“œë§µ ìë™ ìƒì„±
        function generatePersonalizedRoadmap(data) {
            const currentGrade = parseInt(data.grade);
            const roadmap = {
                grade1: [],
                grade2: [],
                grade3: []
            };

            // 1í•™ë…„ ë¡œë“œë§µ
            roadmap.grade1 = [
                'ê¸°ì´ˆ í•™ë ¥ ë‹¤ì§€ê¸°: êµ­ì˜ìˆ˜ ì¤‘ì‹¬ í•™ìŠµ',
                'ì§„ë¡œ íƒìƒ‰: ë‹¤ì–‘í•œ ë¶„ì•¼ ì²´í—˜ í™œë™',
                `ë™ì•„ë¦¬ ì„ íƒ: ${data.department} ê´€ë ¨ ë™ì•„ë¦¬ ê°€ì…`,
                'ë…ì„œ í™œë™: ì›” 2ê¶Œ ì´ìƒ ì „ê³µ ê´€ë ¨ ë„ì„œ',
                'ë´‰ì‚¬í™œë™: í•™ê¸°ë‹¹ 20ì‹œê°„ ì´ìƒ ìˆ˜í–‰'
            ];

            // 2í•™ë…„ ë¡œë“œë§µ
            roadmap.grade2 = [
                'ì‹¬í™” í•™ìŠµ: ì„ íƒê³¼ëª© ì§‘ì¤‘ ê´€ë¦¬',
                `ì „ê³µ íƒêµ¬: ${data.department} ê´€ë ¨ í”„ë¡œì íŠ¸ ìˆ˜í–‰`,
                'êµë‚´ ëŒ€íšŒ: í•™ê¸°ë‹¹ 2ê°œ ì´ìƒ ì°¸ê°€',
                'ì§„ë¡œ í™œë™: ëŒ€í•™ íƒë°© ë° ì „ê³µ ì²´í—˜',
                'ë¦¬ë”ì‹­ í™œë™: í•™ê¸‰/ë™ì•„ë¦¬ ì„ì› í™œë™'
            ];

            // 3í•™ë…„ ë¡œë“œë§µ
            roadmap.grade3 = [
                'ì…ì‹œ ì¤€ë¹„: ìˆ˜ì‹œ/ì •ì‹œ ì „ëµ ìˆ˜ë¦½',
                'ì„±ì  ê´€ë¦¬: ë‚´ì‹  ìµœì¢… ë§ˆë¬´ë¦¬',
                'ìì†Œì„œ ì¤€ë¹„: í™œë™ ì •ë¦¬ ë° ìŠ¤í† ë¦¬ êµ¬ì„±',
                'ë©´ì ‘ ì¤€ë¹„: ì „ê³µ ì§€ì‹ ë° ì‹œì‚¬ í•™ìŠµ',
                'ìµœì¢… ì ê²€: ìƒê¸°ë¶€ í™•ì¸ ë° ë³´ì™„'
            ];

            // í˜„ì¬ í•™ë…„ë³„ ë§ì¶¤ ì¡°ì–¸
            if (currentGrade === 1) {
                roadmap.current = [
                    'íƒìƒ‰ ë‹¨ê³„: ë‹¤ì–‘í•œ í™œë™ì„ í†µí•´ ì ì„± íŒŒì•…',
                    'ê¸°ì´ˆ í•™ë ¥ í–¥ìƒì— ì§‘ì¤‘',
                    'ìƒí™œê¸°ë¡ë¶€ ê¸°ì´ˆ í‹€ ë§ˆë ¨'
                ];
            } else if (currentGrade === 2) {
                roadmap.current = [
                    'ì‹¬í™” ë‹¨ê³„: ì „ê³µ ê´€ë ¨ í™œë™ ì§‘ì¤‘',
                    'ë¦¬ë”ì‹­ê³¼ í˜‘ì—… ëŠ¥ë ¥ ê°œë°œ',
                    'ëª©í‘œ ëŒ€í•™ ì…ì‹œ ì „í˜• ë¶„ì„'
                ];
            } else {
                roadmap.current = [
                    'ì™„ì„± ë‹¨ê³„: ì…ì‹œ ì „ëµ ì‹¤í–‰',
                    'ë¶€ì¡±í•œ ë¶€ë¶„ ì§‘ì¤‘ ë³´ì™„',
                    'ìê¸°ì†Œê°œì„œ ë° ë©´ì ‘ ì¤€ë¹„'
                ];
            }

            return roadmap;
        }

        // ë³´ê³ ì„œ ë‚´ìš© ë™ì  ì—…ë°ì´íŠ¸
        function updateReportContent(data, insights, roadmap) {
            // í†µê³„ ì¹´ë“œ ì—…ë°ì´íŠ¸
            const statsCards = document.querySelectorAll('.stat-card');
            if (statsCards.length >= 4) {
                statsCards[0].querySelector('.stat-value').textContent = data.avgGrade || '-';
                statsCards[1].querySelector('.stat-value').textContent = data.targets.grade || '-';
                statsCards[2].querySelector('.stat-value').textContent = `${insights.overall.possibility}%`;

                // ì˜ˆìƒ ì„ì°¨ ê³„ì‚°
                const avgGrade = parseFloat(data.avgGrade) || 3.0;
                const estimatedRank = Math.round(avgGrade * 10);
                statsCards[3].querySelector('.stat-value').textContent = `ìƒìœ„ ${estimatedRank}%`;
            }

            // AI ì¸ì‚¬ì´íŠ¸ ì—…ë°ì´íŠ¸
            updateAIInsightSections(data, insights);

            // ëŒ€í•™ ì¶”ì²œ ì—…ë°ì´íŠ¸
            updateUniversityRecommendations(data, insights);

            // ë¡œë“œë§µ ì—…ë°ì´íŠ¸
            updateRoadmapSections(roadmap);

            // í•™êµ ë§ì¶¤ ì „ëµ ì—…ë°ì´íŠ¸
            if (selectedSchoolCode) {
                updateSchoolStrategy(data);
            }
        }

        // AI ì¸ì‚¬ì´íŠ¸ ì„¹ì…˜ ì—…ë°ì´íŠ¸
        function updateAIInsightSections(data, insights) {
            // ì„±ì  ë¶„ì„ ì¸ì‚¬ì´íŠ¸
            const gradeInsights = document.querySelectorAll('.insight-box')[0];
            if (gradeInsights) {
                let gradeText = `<strong>${data.name}</strong> í•™ìƒì˜ ì„±ì  ë¶„ì„ ê²°ê³¼:<br><br>`;

                if (insights.grades.strong.length > 0) {
                    gradeText += `âœ… <strong>ê°•ì  ê³¼ëª©:</strong> ${insights.grades.strong.join(', ')}<br>`;
                }
                if (insights.grades.weak.length > 0) {
                    gradeText += `âš ï¸ <strong>ë³´ì™„ í•„ìš”:</strong> ${insights.grades.weak.join(', ')}<br>`;
                }
                gradeText += `<br>ğŸ“Š <strong>í‰ê·  ë“±ê¸‰:</strong> ${data.avgGrade}ë“±ê¸‰<br>`;
                gradeText += `ğŸ¯ <strong>ëª©í‘œ ë“±ê¸‰:</strong> ${data.targets.grade}ë“±ê¸‰`;

                gradeInsights.innerHTML = gradeText;
            }

            // í™œë™ ë¶„ì„ ì¸ì‚¬ì´íŠ¸
            const activityInsights = document.querySelectorAll('.insight-box')[1];
            if (activityInsights) {
                let activityText = '<strong>í™œë™ í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„:</strong><br><br>';

                if (insights.activities.strong.length > 0) {
                    activityText += `âœ… <strong>ìš°ìˆ˜ ì˜ì—­:</strong><br>`;
                    insights.activities.strong.forEach(item => {
                        activityText += `â€¢ ${item}<br>`;
                    });
                }
                if (insights.activities.lacking.length > 0) {
                    activityText += `<br>ğŸ“Œ <strong>ë³´ê°• í•„ìš”:</strong><br>`;
                    insights.activities.lacking.forEach(item => {
                        activityText += `â€¢ ${item}<br>`;
                    });
                }

                activityInsights.innerHTML = activityText;
            }

            // ì¢…í•© í‰ê°€ ì¸ì‚¬ì´íŠ¸
            const overallInsights = document.querySelectorAll('.insight-box')[2];
            if (overallInsights) {
                let overallText = `<strong>${data.targets.univ1}</strong> ${data.department} í•©ê²© ê°€ëŠ¥ì„± ë¶„ì„:<br><br>`;
                overallText += `ğŸ¯ <strong>í•©ê²© ê°€ëŠ¥ì„±:</strong> ${insights.overall.possibility}%<br><br>`;

                if (insights.activities.recommendations.length > 0) {
                    overallText += `ğŸ’¡ <strong>ì¶”ì²œ í™œë™:</strong><br>`;
                    insights.activities.recommendations.forEach(item => {
                        overallText += `â€¢ ${item}<br>`;
                    });
                }

                overallInsights.innerHTML = overallText;
            }
        }

        // ëŒ€í•™ ì¶”ì²œ ì—…ë°ì´íŠ¸
        function updateUniversityRecommendations(data, insights) {
            const avgGrade = parseFloat(data.avgGrade) || 3.0;
            const tierBoxes = document.querySelectorAll('.tier-box');

            // ëŒ€í•™ ëª©ë¡ (ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ëŒ€ì²´ í•„ìš”)
            const universities = {
                challenge: [],
                appropriate: [],
                safety: []
            };

            if (avgGrade <= 1.5) {
                universities.challenge = ['ì„œìš¸ëŒ€', 'ì—°ì„¸ëŒ€', 'ê³ ë ¤ëŒ€'];
                universities.appropriate = ['ì„±ê· ê´€ëŒ€', 'í•œì–‘ëŒ€', 'ì„œê°•ëŒ€'];
                universities.safety = ['ì¤‘ì•™ëŒ€', 'ê²½í¬ëŒ€', 'í•œêµ­ì™¸ëŒ€'];
            } else if (avgGrade <= 2.0) {
                universities.challenge = ['ì„±ê· ê´€ëŒ€', 'í•œì–‘ëŒ€', 'ì„œê°•ëŒ€'];
                universities.appropriate = ['ì¤‘ì•™ëŒ€', 'ê²½í¬ëŒ€', 'í•œêµ­ì™¸ëŒ€'];
                universities.safety = ['ê±´êµ­ëŒ€', 'ë™êµ­ëŒ€', 'í™ìµëŒ€'];
            } else if (avgGrade <= 2.5) {
                universities.challenge = ['ì¤‘ì•™ëŒ€', 'ê²½í¬ëŒ€', 'í•œêµ­ì™¸ëŒ€'];
                universities.appropriate = ['ê±´êµ­ëŒ€', 'ë™êµ­ëŒ€', 'í™ìµëŒ€'];
                universities.safety = ['ìˆ­ì‹¤ëŒ€', 'ì„¸ì¢…ëŒ€', 'ê´‘ìš´ëŒ€'];
            } else {
                universities.challenge = ['ê±´êµ­ëŒ€', 'ë™êµ­ëŒ€', 'í™ìµëŒ€'];
                universities.appropriate = ['ìˆ­ì‹¤ëŒ€', 'ì„¸ì¢…ëŒ€', 'ê´‘ìš´ëŒ€'];
                universities.safety = ['ëª…ì§€ëŒ€', 'ìƒëª…ëŒ€', 'ì„œìš¸ê³¼ê¸°ëŒ€'];
            }

            // ë„ì „ ëŒ€í•™
            if (tierBoxes[0]) {
                const univList = tierBoxes[0].querySelector('.tier-universities');
                if (data.targets.univ1 && !universities.challenge.includes(data.targets.univ1)) {
                    universities.challenge.unshift(data.targets.univ1);
                }
                univList.innerHTML = universities.challenge.map(univ =>
                    `<span class="university-chip">${univ} ${data.department}</span>`
                ).join('');
            }

            // ì ì • ëŒ€í•™
            if (tierBoxes[1]) {
                const univList = tierBoxes[1].querySelector('.tier-universities');
                if (data.targets.univ2 && !universities.appropriate.includes(data.targets.univ2)) {
                    universities.appropriate.unshift(data.targets.univ2);
                }
                univList.innerHTML = universities.appropriate.map(univ =>
                    `<span class="university-chip">${univ} ${data.department}</span>`
                ).join('');
            }

            // ì•ˆì • ëŒ€í•™
            if (tierBoxes[2]) {
                const univList = tierBoxes[2].querySelector('.tier-universities');
                univList.innerHTML = universities.safety.map(univ =>
                    `<span class="university-chip">${univ} ${data.department}</span>`
                ).join('');
            }
        }

        // ë¡œë“œë§µ ì„¹ì…˜ ì—…ë°ì´íŠ¸
        function updateRoadmapSections(roadmap) {
            // 1í•™ë…„ ë¡œë“œë§µ
            const grade1Section = document.querySelectorAll('.timeline-grade')[0];
            if (grade1Section) {
                const itemsContainer = grade1Section.querySelector('.timeline-items');
                itemsContainer.innerHTML = roadmap.grade1.map(item =>
                    `<div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">${item}</div>
                        </div>
                    </div>`
                ).join('');
            }

            // 2í•™ë…„ ë¡œë“œë§µ
            const grade2Section = document.querySelectorAll('.timeline-grade')[1];
            if (grade2Section) {
                const itemsContainer = grade2Section.querySelector('.timeline-items');
                itemsContainer.innerHTML = roadmap.grade2.map(item =>
                    `<div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">${item}</div>
                        </div>
                    </div>`
                ).join('');
            }

            // 3í•™ë…„ ë¡œë“œë§µ
            const grade3Section = document.querySelectorAll('.timeline-grade')[2];
            if (grade3Section) {
                const itemsContainer = grade3Section.querySelector('.timeline-items');
                itemsContainer.innerHTML = roadmap.grade3.map(item =>
                    `<div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">${item}</div>
                        </div>
                    </div>`
                ).join('');
            }
        }

        // í•™êµ ë§ì¶¤ ì „ëµ ì—…ë°ì´íŠ¸
        function updateSchoolStrategy(data) {
            const strategyList = document.querySelector('.strategy-list');
            if (strategyList && schoolDetailData) {
                let strategies = [];

                // í•™êµ ë°ì´í„° ê¸°ë°˜ ì „ëµ ìƒì„±
                strategies.push(`<strong>${data.grade}í•™ë…„ ${data.semester}í•™ê¸°:</strong> í˜„ì¬ ì‹œê¸° í•µì‹¬ í™œë™ ì§‘ì¤‘`);
                strategies.push(`<strong>êµë‚´ í™œë™:</strong> ${data.schoolName} íŠ¹ìƒ‰ í”„ë¡œê·¸ë¨ ì°¸ì—¬`);
                strategies.push(`<strong>${data.department}:</strong> ì „ê³µ ê´€ë ¨ ì„ íƒê³¼ëª© ìˆ˜ê°• í•„ìˆ˜`);
                strategies.push(`<strong>ì„±ì  ê´€ë¦¬:</strong> í‰ê·  ${data.targets.grade}ë“±ê¸‰ ëª©í‘œ`);
                strategies.push(`<strong>ìƒê¸°ë¶€:</strong> ê³¼ëª©ë³„ ì„¸íŠ¹ ë‚´ìš© ì¶©ì‹¤íˆ ê¸°ë¡`);

                strategyList.innerHTML = strategies.map(strategy => `<li>${strategy}</li>`).join('');
            }
        }

        // ì¶”ê°€ í•™êµ ë°ì´í„° ë¡œë“œ (ì‹œê°„í‘œ, êµìœ¡ê³¼ì •, í•™ì‚¬ì¼ì • ë“±)
        async function loadAdditionalSchoolData() {
            try {
                const year = new Date().getFullYear();
                const promises = [];

                // 1. ì‹œê°„í‘œ ì •ë³´
                const timeTableUrl = `https://open.neis.go.kr/hub/hisTimetable?KEY=${NEIS_API_KEY}&Type=json&ATPT_OFCDC_SC_CODE=${selectedSchoolCode.ATPT_OFCDC_SC_CODE}&SD_SCHUL_CODE=${selectedSchoolCode.SD_SCHUL_CODE}&AY=${year}`;
                promises.push(fetch(timeTableUrl).then(res => res.json()));

                // 2. í•™ì‚¬ì¼ì •
                const scheduleUrl = `https://open.neis.go.kr/hub/SchoolSchedule?KEY=${NEIS_API_KEY}&Type=json&ATPT_OFCDC_SC_CODE=${selectedSchoolCode.ATPT_OFCDC_SC_CODE}&SD_SCHUL_CODE=${selectedSchoolCode.SD_SCHUL_CODE}&AA_YMD=${year}01&AA_TO_YMD=${year}12`;
                promises.push(fetch(scheduleUrl).then(res => res.json()));

                // 3. í•™ê³¼ì •ë³´
                const majorUrl = `https://open.neis.go.kr/hub/schoolMajorinfo?KEY=${NEIS_API_KEY}&Type=json&ATPT_OFCDC_SC_CODE=${selectedSchoolCode.ATPT_OFCDC_SC_CODE}&SD_SCHUL_CODE=${selectedSchoolCode.SD_SCHUL_CODE}`;
                promises.push(fetch(majorUrl).then(res => res.json()));

                const results = await Promise.allSettled(promises);

                // ì‹œê°„í‘œ ë°ì´í„°
                if (results[0].status === 'fulfilled' && results[0].value.hisTimetable) {
                    schoolDetailData.timetable = results[0].value.hisTimetable[1]?.row || [];
                    console.log('ì‹œê°„í‘œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                }

                // í•™ì‚¬ì¼ì • ë°ì´í„°
                if (results[1].status === 'fulfilled' && results[1].value.SchoolSchedule) {
                    schoolDetailData.schedule = results[1].value.SchoolSchedule[1]?.row || [];
                    console.log('í•™ì‚¬ì¼ì • ë°ì´í„° ë¡œë“œ ì™„ë£Œ');

                    // ì£¼ìš” í–‰ì‚¬ ì¶”ì¶œ
                    const majorEvents = schoolDetailData.schedule.filter(event =>
                        event.EVENT_NM.includes('ëŒ€íšŒ') ||
                        event.EVENT_NM.includes('ê²½ì‹œ') ||
                        event.EVENT_NM.includes('í‰ê°€')
                    );
                    schoolDetailData.majorEvents = majorEvents;
                }

                // í•™ê³¼ì •ë³´ ë°ì´í„°
                if (results[2].status === 'fulfilled' && results[2].value.schoolMajorinfo) {
                    schoolDetailData.majors = results[2].value.schoolMajorinfo[1]?.row || [];
                    console.log('í•™ê³¼ì •ë³´ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                }

            } catch (error) {
                console.error('ì¶”ê°€ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
                schoolDetailData = {}; // ì—ëŸ¬ ì‹œ ë¹ˆ ê°ì²´ë¡œ ì´ˆê¸°í™”
            }
        }


        // êµìœ¡ê³¼ì • ì„¹ì…˜ ì—…ë°ì´íŠ¸
        function updateCurriculumSection() {
            // ì‹œê°„í‘œ ë°ì´í„°ì—ì„œ ê°œì„¤ ê³¼ëª© ì¶”ì¶œ
            if (window.timeTableData && window.timeTableData.hisTimetable && window.timeTableData.hisTimetable[1]) {
                const subjects = window.timeTableData.hisTimetable[1].row;
                const uniqueSubjects = [...new Set(subjects.map(s => s.ITRT_CNTNT))];

                console.log('ê°œì„¤ ê³¼ëª©:', uniqueSubjects);

                // ê°œì„¤ ê³¼ëª© í‘œì‹œ ì—…ë°ì´íŠ¸
                const subjectsHtml = uniqueSubjects.slice(0, 10).map(subject =>
                    `<span class="badge badge-primary">${subject}</span>`
                ).join(' ');

                // êµìœ¡ê³¼ì • í…Œì´ë¸”ì˜ ê°œì„¤ ê³¼ëª© í–‰ ì°¾ì•„ì„œ ì—…ë°ì´íŠ¸
                const rows = document.querySelectorAll('.data-table tbody tr');
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    if (cells[0] && cells[0].textContent.includes('ê°œì„¤ ì„ íƒê³¼ëª©')) {
                        cells[1].innerHTML = subjectsHtml + ` ì™¸ ${uniqueSubjects.length - 10}ê³¼ëª©`;
                    }
                });
            }

            // ë¶„ì„ ê²°ê³¼ ì—…ë°ì´íŠ¸
            const analysisBox = document.querySelector('.strategy-content');
            if (analysisBox && selectedSchoolCode) {
                const schoolName = document.getElementById('schoolName').value;
                analysisBox.innerHTML = `
                    <strong>${schoolName}</strong>ì˜ ì‹¤ì œ êµìœ¡ê³¼ì • ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤.
                    í•™êµì•Œë¦¬ë¯¸ APIë¥¼ í†µí•´ ${window.timeTableData ? 'ì‹œê°„í‘œ ì •ë³´' : 'êµìœ¡ê³¼ì • ì •ë³´'}ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.
                    í•´ë‹¹ í•™êµì˜ íŠ¹ìƒ‰ì‚¬ì—…ê³¼ ê°œì„¤ ê³¼ëª©ì„ ê³ ë ¤í•œ ë§ì¶¤í˜• í™œë™ ê³„íšì„ ìˆ˜ë¦½í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
                `;
            }
        }


        // API ì¸ì¦í‚¤
        const NEIS_API_KEY = 'cdf2d5e7030b405fa10d0198207464e3';
        const SCHOOLINFO_API_KEY = 'b9a52111e6b64fc9ab50d52aa2619e0a';

        let selectedSchoolCode = null;
        let searchTimeout = null;
        let departmentSearchTimeout = null;
        let additionalSubjectCount = 0;
        let currentStep = 1;

        // ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™í•˜ëŠ” í•¨ìˆ˜
        window.goToNextStep = function(stepNumber) {
            // í˜„ì¬ ë‹¨ê³„ ì™„ë£Œ í‘œì‹œ
            const currentCard = document.getElementById(`stepCard${currentStep}`);
            if (currentCard) {
                currentCard.classList.add('completed');
            }

            // ë‹¤ìŒ ë‹¨ê³„ ë³´ì´ê¸°
            const nextCard = document.getElementById(`stepCard${stepNumber}`);
            if (nextCard) {
                nextCard.classList.add('visible');

                // ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
                setTimeout(() => {
                    nextCard.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
            }

            currentStep = stepNumber;
        }

        // ì¶”ê°€ ê³¼ëª© ì…ë ¥ í•¨ìˆ˜
        window.addSubject = function() {
            additionalSubjectCount++;
            const container = document.getElementById('additionalSubjectsContainer');

            const subjectDiv = document.createElement('div');
            subjectDiv.className = 'form-row';
            subjectDiv.id = `additionalSubject${additionalSubjectCount}`;
            subjectDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background: white; border-radius: 10px; position: relative; animation: slideIn 0.3s ease-out;';

            subjectDiv.innerHTML = `
                <div class="form-group" style="margin-bottom: 0;">
                    <label>ê³¼ëª©ëª…</label>
                    <input type="text" id="subjectName${additionalSubjectCount}" placeholder="ì˜ˆ: ë¬¼ë¦¬í•™I, í™”í•™I, ìƒëª…ê³¼í•™I" style="margin-bottom: 10px;">
                </div>
                <div class="form-group" style="margin-bottom: 0;">
                    <label>ë“±ê¸‰</label>
                    <select id="subjectGrade${additionalSubjectCount}">
                        <option value="">ì„ íƒ</option>
                        <option value="1">1ë“±ê¸‰</option>
                        <option value="2">2ë“±ê¸‰</option>
                        <option value="3">3ë“±ê¸‰</option>
                        <option value="4">4ë“±ê¸‰</option>
                        <option value="5">5ë“±ê¸‰</option>
                        <option value="6">6ë“±ê¸‰</option>
                        <option value="7">7ë“±ê¸‰</option>
                        <option value="8">8ë“±ê¸‰</option>
                        <option value="9">9ë“±ê¸‰</option>
                    </select>
                </div>
                <button type="button" onclick="removeSubject(${additionalSubjectCount})" style="position: absolute; top: 10px; right: 10px; background: #fee2e2; color: #ef4444; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-weight: bold; transition: all 0.2s;" onmouseover="this.style.background='#ef4444'; this.style.color='white';" onmouseout="this.style.background='#fee2e2'; this.style.color='#ef4444';">Ã—</button>
            `;

            container.appendChild(subjectDiv);

            // ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íƒ€ì¼ ì¶”ê°€
            if (!document.getElementById('slideInAnimation')) {
                const style = document.createElement('style');
                style.id = 'slideInAnimation';
                style.textContent = `
                    @keyframes slideIn {
                        from {
                            opacity: 0;
                            transform: translateY(-10px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // ì¶”ê°€ ê³¼ëª© ì œê±° í•¨ìˆ˜
        window.removeSubject = function(id) {
            const subjectDiv = document.getElementById(`additionalSubject${id}`);
            if (subjectDiv) {
                subjectDiv.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => {
                    subjectDiv.remove();
                }, 300);
            }

            // ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íƒ€ì¼ ì¶”ê°€
            if (!document.getElementById('slideOutAnimation')) {
                const style = document.createElement('style');
                style.id = 'slideOutAnimation';
                style.textContent = `
                    @keyframes slideOut {
                        from {
                            opacity: 1;
                            transform: translateY(0);
                        }
                        to {
                            opacity: 0;
                            transform: translateY(-10px);
                        }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // ì „êµ­ ì£¼ìš” í•™ê³¼/ì „ê³µ ë°ì´í„°ë² ì´ìŠ¤
        const allDepartments = [
            'ì—†ìŒ',
            // ê³µí•™ê³„ì—´
            'AIí•™ê³¼', 'ê°€ìŠ¤ì•ˆì „ê³µí•™ê³¼', 'ê±´ì„¤í™˜ê²½ê³µí•™ê³¼', 'ê±´ì¶•ê³µí•™ê³¼', 'ê±´ì¶•í•™ê³¼',
            'ê²Œì„í•™ê³¼', 'ê³ ë¶„ìê³µí•™ê³¼', 'ê³µê°„ì •ë³´ê³µí•™ê³¼', 'ê´‘í•™ê³µí•™ê³¼', 'êµí†µê³µí•™ê³¼',
            'êµ­ë°©ë””ì§€í„¸ìœµí•©í•™ê³¼', 'ê¸°ê³„ê³µí•™ê³¼', 'ê¸°ê³„ì„¤ê³„ê³µí•™ê³¼', 'ê¸°ê³„ì‹œìŠ¤í…œê³µí•™ê³¼', 'ê¸°ê³„ìë™ì°¨ê³µí•™ê³¼',
            'ê¸°ê³„í•­ê³µìš°ì£¼ê³µí•™ê³¼', 'ë‚˜ë…¸ê³µí•™ê³¼', 'ë‚˜ë…¸ì†Œì¬ê³µí•™ê³¼', 'ëƒ‰ë™ê³µì¡°ê³µí•™ê³¼', 'ë…¹ìƒ‰ê¸°ìˆ ìœµí•©í•™ê³¼',
            'ë†ê³µí•™ê³¼', 'ë†ì—…ê³µí•™ê³¼', 'ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤í•™ê³¼', 'ë„ì‹œê³µí•™ê³¼', 'ë°˜ë„ì²´ê³µí•™ê³¼',
            'ë°©ì¬ì•ˆì „ê³µí•™ê³¼', 'ë°©ì†¡ê³µí•™ê³¼', 'ë©€í‹°ë¯¸ë””ì–´ê³µí•™ê³¼', 'ë©”ì¹´íŠ¸ë¡œë‹‰ìŠ¤ê³µí•™ê³¼', 'ë°”ì´ì˜¤ë©”ë””ì»¬ê³µí•™ê³¼',
            'ë°”ì´ì˜¤ì‹œìŠ¤í…œê³µí•™ê³¼', 'ë°”ì´ì˜¤ìœµí•©ê³µí•™ê³¼', 'ë°”ì´ì˜¤í—¬ìŠ¤ìœµí•©í•™ê³¼', 'ë°˜ë„ì²´ë””ìŠ¤í”Œë ˆì´ê³µí•™ê³¼', 'ì‚°ì—…ê³µí•™ê³¼',
            'ì‚°ì—…ê²½ì˜ê³µí•™ê³¼', 'ì‚°ì—…ë””ìì¸ê³µí•™ê³¼', 'ì‚°ì—…ë³´ì•ˆí•™ê³¼', 'ì‚°ì—…ì‹œìŠ¤í…œê³µí•™ê³¼', 'ì„¬ìœ ê³µí•™ê³¼',
            'ì†Œë°©ë°©ì¬í•™ê³¼', 'ì†Œë°©ì•ˆì „ê³µí•™ê³¼', 'ì†Œí”„íŠ¸ì›¨ì–´í•™ê³¼', 'ì†Œí”„íŠ¸ì›¨ì–´ìœµí•©í•™ê³¼', 'ìˆ˜ë¦¬í•™ê³¼',
            'ìŠ¤ë§ˆíŠ¸ëª¨ë¹Œë¦¬í‹°í•™ê³¼', 'ìŠ¤ë§ˆíŠ¸ìë™ì°¨í•™ê³¼', 'ì‹ ì†Œì¬ê³µí•™ê³¼', 'ì‹ ì—ë„ˆì§€ê³µí•™ê³¼', 'ì•ˆê²½ê´‘í•™ê³¼',
            'ì•ˆì „ê³µí•™ê³¼', 'ì—ë„ˆì§€ê³µí•™ê³¼', 'ì—ë„ˆì§€ìì›ê³µí•™ê³¼', 'ì›ìë ¥ê³µí•™ê³¼', 'ì›ì˜ˆìƒëª…ê³µí•™ê³¼',
            'ìœµí•©ê³µí•™ê³¼', 'ì˜ê³µí•™ê³¼', 'ì˜ë£Œê³µí•™ê³¼', 'ì˜ë£ŒITí•™ê³¼', 'ì¸ê³µì§€ëŠ¥í•™ê³¼',
            'ì¸ë”ìŠ¤íŠ¸ë¦¬ì–¼ë””ìì¸í•™ê³¼', 'ìë™ì°¨ê³µí•™ê³¼', 'ì¬ë£Œê³µí•™ê³¼', 'ì „ê¸°ê³µí•™ê³¼', 'ì „ê¸°ì „ìê³µí•™ê³¼',
            'ì „ìê³µí•™ê³¼', 'ì „ìë””ìŠ¤í”Œë ˆì´ê³µí•™ê³¼', 'ì „ìì „ê¸°ê³µí•™ë¶€', 'ì „ìì¬ë£Œê³µí•™ê³¼', 'ì •ë³´ë³´ì•ˆí•™ê³¼',
            'ì •ë³´í†µì‹ ê³µí•™ê³¼', 'ì œì–´ê³„ì¸¡ê³µí•™ê³¼', 'ì¡°ì„ í•´ì–‘ê³µí•™ê³¼', 'ì§€êµ¬í™˜ê²½ê³µí•™ê³¼', 'ì§€ëŠ¥ê¸°ì „ê³µí•™ê³¼',
            'ì§€ëŠ¥ë¡œë´‡ê³µí•™ê³¼', 'ì§€ëŠ¥ì •ë³´ê³µí•™ê³¼', 'ì§€ì—­ê±´ì„¤ê³µí•™ê³¼', 'ì² ë„ê³µí•™ê³¼', 'ì»´í“¨í„°ê³µí•™ê³¼',
            'ì»´í“¨í„°ì†Œí”„íŠ¸ì›¨ì–´í•™ë¶€', 'ì»´í“¨í„°ì •ë³´ê³µí•™ê³¼', 'í† ëª©ê³µí•™ê³¼', 'í† ëª©í™˜ê²½ê³µí•™ê³¼', 'í†µì‹ ê³µí•™ê³¼',
            'í”ŒëœíŠ¸í™”í•™ê³µí•™ê³¼', 'í•­ê³µìš°ì£¼ê³µí•™ê³¼', 'í•­ê³µì •ë¹„í•™ê³¼', 'í•´ì–‘ê³µí•™ê³¼', 'í™”í•™ê³µí•™ê³¼',
            'í™”í•™ìƒëª…ê³µí•™ê³¼', 'í™˜ê²½ê³µí•™ê³¼', 'í™˜ê²½ì—ë„ˆì§€ê³µí•™ê³¼', 'ìœµí•©ë³´ì•ˆí•™ê³¼', 'ì‚¬ì´ë²„ë³´ì•ˆí•™ê³¼',
            'ë¸”ë¡ì²´ì¸í•™ê³¼', 'ICTìœµí•©í•™ê³¼', 'IoTí•™ê³¼',

            // ìì—°ê³„ì—´
            'ê°„í˜¸í•™ê³¼', 'ëŒ€ê¸°ê³¼í•™ê³¼', 'ë¬¼ë¦¬í•™ê³¼', 'ë¯¸ìƒë¬¼í•™ê³¼', 'ë°”ì´ì˜¤ë©”ë””ì»¬í•™ê³¼',
            'ë¶„ììƒëª…ê³¼í•™ê³¼', 'ìƒëª…ê³¼í•™ê³¼', 'ìƒëª…ê³µí•™ê³¼', 'ìƒë¬¼í•™ê³¼', 'ìƒí™”í•™ê³¼',
            'ìˆ˜í•™ê³¼', 'ìˆ˜í•™í†µê³„í•™ë¶€', 'ì‹í’ˆìƒëª…ê³µí•™ê³¼', 'ì‹í’ˆì˜ì–‘í•™ê³¼', 'ì•½í•™ê³¼',
            'ì‘ìš©ìˆ˜í•™ê³¼', 'ì‘ìš©ìƒë¬¼í•™ê³¼', 'ì‘ìš©í†µê³„í•™ê³¼', 'ì˜ìƒëª…ê³¼í•™ê³¼', 'ì„ìƒë³‘ë¦¬í•™ê³¼',
            'ìì—°ê³¼í•™ë¶€', 'ì²œë¬¸ìš°ì£¼í•™ê³¼', 'í†µê³„í•™ê³¼', 'í•´ì–‘ìƒëª…ê³¼í•™ê³¼', 'í•´ì–‘í•™ê³¼',
            'í™”í•™ê³¼', 'í™”ì¥í’ˆí•™ê³¼', 'í™˜ê²½ìƒëª…ê³¼í•™ê³¼', 'í™˜ê²½í•™ê³¼', 'ìœ ì „ê³µí•™ê³¼',
            'ë¶„ììƒë¬¼í•™ê³¼', 'ë‡Œê³¼í•™ê³¼', 'ì¸ì§€ê³¼í•™ê³¼', 'ì˜ì˜ˆê³¼', 'ì¹˜ì˜ì˜ˆê³¼', 'í•œì˜ì˜ˆê³¼', 'ìˆ˜ì˜ì˜ˆê³¼',

            // ì¸ë¬¸ê³„ì—´
            'êµ­ì‚¬í•™ê³¼', 'êµ­ì–´êµ­ë¬¸í•™ê³¼', 'ë…¸ì–´ë…¸ë¬¸í•™ê³¼', 'ë™ì–‘ì‚¬í•™ê³¼', 'ë…ì–´ë…ë¬¸í•™ê³¼',
            'ë¬¸í—Œì •ë³´í•™ê³¼', 'ë¬¸í™”ì¸ë¥˜í•™ê³¼', 'ë¯¸êµ­í•™ê³¼', 'ë¶ˆì–´ë¶ˆë¬¸í•™ê³¼', 'ì‚¬í•™ê³¼',
            'ì„œì–‘ì‚¬í•™ê³¼', 'ìŠ¤í˜ì¸ì–´ê³¼', 'ì•„ëì–´ê³¼', 'ì•„ì‹œì•„í•™ê³¼', 'ì–¸ì–´í•™ê³¼',
            'ì˜ë¯¸ë¬¸í™”í•™ê³¼', 'ì˜ì–´ì˜ë¬¸í•™ê³¼', 'ì¼ë³¸í•™ê³¼', 'ì¼ì–´ì¼ë¬¸í•™ê³¼', 'ì¤‘êµ­í•™ê³¼',
            'ì¤‘ì–´ì¤‘ë¬¸í•™ê³¼', 'ì² í•™ê³¼', 'í¬ë¥´íˆ¬ê°ˆì–´ê³¼', 'í•œêµ­ì–´í•™ê³¼', 'í•œêµ­í•™ê³¼',
            'í•œë¬¸í•™ê³¼', 'ëŸ¬ì‹œì•„í•™ê³¼', 'ì´íƒˆë¦¬ì•„ì–´ê³¼', 'í´ë€ë“œì–´ê³¼', 'í„°í‚¤ì–´ê³¼',
            'ë² íŠ¸ë‚¨ì–´ê³¼', 'ì¸ë„í•™ê³¼', 'ê³ ê³ í•™ê³¼', 'ê¸°ë¡ê´€ë¦¬í•™ê³¼', 'ë¬¸í™”ì¬í•™ê³¼',

            // ì‚¬íšŒê³„ì—´
            'ê²½ì˜í•™ê³¼', 'ê²½ì˜ì •ë³´í•™ê³¼', 'ê²½ì œí•™ê³¼', 'ê´€ê´‘ê²½ì˜í•™ê³¼', 'ê´€ê´‘í•™ê³¼',
            'êµì •ë³´í˜¸í•™ê³¼', 'êµ­ì œê´€ê³„í•™ê³¼', 'êµ­ì œë¬¼ë¥˜í•™ê³¼', 'êµ­ì œí†µìƒí•™ê³¼', 'ê¸€ë¡œë²Œê²½ì˜í•™ê³¼',
            'ê¸€ë¡œë²Œë¹„ì¦ˆë‹ˆìŠ¤í•™ê³¼', 'ê¸ˆìœµë³´í—˜í•™ê³¼', 'ê¸ˆìœµí•™ê³¼', 'ë…¸ë™í•™ê³¼', 'ë„ì‹œê³„íší•™ê³¼',
            'ë¬´ì—­í•™ê³¼', 'ë¬¸í™”ì½˜í…ì¸ í•™ê³¼', 'ë¯¸ë””ì–´ì»¤ë®¤ë‹ˆì¼€ì´ì…˜í•™ê³¼', 'ë²¤ì²˜ê²½ì˜í•™ê³¼', 'ë²•í•™ê³¼',
            'ë¶€ë™ì‚°í•™ê³¼', 'ì‚¬íšŒë³µì§€í•™ê³¼', 'ì‚¬íšŒí•™ê³¼', 'ì„¸ë¬´íšŒê³„í•™ê³¼', 'ì†Œë¹„ìí•™ê³¼',
            'ì–¸ë¡ ì •ë³´í•™ê³¼', 'ì™¸êµí•™ê³¼', 'ìœ í†µí•™ê³¼', 'ì¸ë¥˜í•™ê³¼', 'ì¬ë¬´ê¸ˆìœµí•™ê³¼',
            'ì •ë³´ì‚¬íšŒí•™ê³¼', 'ì •ì¹˜ì™¸êµí•™ê³¼', 'ì¡°ì„¸í•™ê³¼', 'ì§€ë¦¬í•™ê³¼', 'ì°½ì—…í•™ê³¼',
            'í–‰ì •í•™ê³¼', 'í˜¸í…”ê²½ì˜í•™ê³¼', 'í˜¸í…”ê´€ê´‘í•™ê³¼', 'íšŒê³„í•™ê³¼', 'ê´‘ê³ í™ë³´í•™ê³¼',
            'ì‹ ë¬¸ë°©ì†¡í•™ê³¼', 'ë””ì§€í„¸ë¯¸ë””ì–´í•™ê³¼', 'ê´‘ê³ í•™ê³¼', 'í™ë³´í•™ê³¼', 'ë§ˆì¼€íŒ…í•™ê³¼',
            'ê²½ì˜ì»¨ì„¤íŒ…í•™ê³¼', 'e-ë¹„ì¦ˆë‹ˆìŠ¤í•™ê³¼', 'ì‹¬ë¦¬í•™ê³¼', 'ìƒë‹´ì‹¬ë¦¬í•™ê³¼', 'ì‚°ì—…ì‹¬ë¦¬í•™ê³¼',

            // êµìœ¡ê³„ì—´
            'ê°€ì •êµìœ¡ê³¼', 'ê±´ê°•êµìœ¡ê³¼', 'êµìœ¡ê³µí•™ê³¼', 'êµìœ¡í•™ê³¼', 'êµ­ì–´êµìœ¡ê³¼',
            'ê¸°ìˆ êµìœ¡ê³¼', 'ë„ë•ìœ¤ë¦¬êµìœ¡ê³¼', 'ë¬¼ë¦¬êµìœ¡ê³¼', 'ë¯¸ìˆ êµìœ¡ê³¼', 'ì‚¬íšŒêµìœ¡ê³¼',
            'ìƒë¬¼êµìœ¡ê³¼', 'ìˆ˜í•™êµìœ¡ê³¼', 'ì—­ì‚¬êµìœ¡ê³¼', 'ì˜ì–´êµìœ¡ê³¼', 'ìœ ì•„êµìœ¡ê³¼',
            'ìœ¤ë¦¬êµìœ¡ê³¼', 'ì¼ë°˜ì‚¬íšŒêµìœ¡ê³¼', 'ì¼ì–´êµìœ¡ê³¼', 'ì§€êµ¬ê³¼í•™êµìœ¡ê³¼', 'ì§€ë¦¬êµìœ¡ê³¼',
            'ì²´ìœ¡êµìœ¡ê³¼', 'ì´ˆë“±êµìœ¡ê³¼', 'ì»´í“¨í„°êµìœ¡ê³¼', 'í†µí•©êµìœ¡ê³¼', 'íŠ¹ìˆ˜êµìœ¡ê³¼',
            'í™”í•™êµìœ¡ê³¼', 'í™˜ê²½êµìœ¡ê³¼', 'ìŒì•…êµìœ¡ê³¼', 'í•œë¬¸êµìœ¡ê³¼', 'STEMêµìœ¡ê³¼',

            // ì˜ˆì²´ëŠ¥ê³„ì—´
            'ê²Œì„ë””ìì¸ê³¼', 'ê³µì—°ì˜ˆìˆ í•™ê³¼', 'ê³µì˜ˆí•™ê³¼', 'ê´€í˜„ì•…ê³¼', 'êµ­ì•…ê³¼',
            'ë®¤ì§€ì»¬í•™ê³¼', 'ë¬´ìš©í•™ê³¼', 'ë¬¸ì˜ˆì°½ì‘ê³¼', 'ë°©ì†¡ì—°ì˜ˆê³¼', 'ë³´ì»¬ê³¼',
            'ì‚°ì—…ë””ìì¸ê³¼', 'ìƒí™œë””ìì¸ê³¼', 'ì„œì–‘í™”ê³¼', 'ì„±ì•…ê³¼', 'ìŠ¤í¬ì¸ ê³¼í•™ê³¼',
            'ì‹œê°ë””ìì¸ê³¼', 'ì‹¤ë‚´ê±´ì¶•ë””ìì¸ê³¼', 'ì‹¤ë‚´ë””ìì¸ê³¼', 'ì‹¤ìš©ìŒì•…ê³¼', 'ì—°ê·¹ì˜í™”ê³¼',
            'ì˜ìƒë””ìì¸ê³¼', 'ì˜í™”ê³¼', 'ìš´ë™ìƒë¦¬í•™ê³¼', 'ìš´ë™ì¬í™œí•™ê³¼', 'ì˜ìƒë””ìì¸ê³¼',
            'ì‘ê³¡ê³¼', 'ì œí’ˆë””ìì¸ê³¼', 'ì¡°ì†Œê³¼', 'ì¡°í˜•ì˜ˆìˆ í•™ê³¼', 'ì²´ìœ¡í•™ê³¼',
            'ì»´í“¨í„°ê·¸ë˜í”½ë””ìì¸ê³¼', 'íŒ¨ì…˜ë””ìì¸ê³¼', 'í”¼ì•„ë…¸ê³¼', 'í•œêµ­í™”ê³¼', 'í˜„ëŒ€ì‹¤ìš©ìŒì•…ê³¼',
            'íšŒí™”ê³¼', 'e-ìŠ¤í¬ì¸ í•™ê³¼', 'ê²Œì„ê·¸ë˜í”½ë””ìì¸ê³¼', 'ì• ë‹ˆë©”ì´ì…˜í•™ê³¼', 'ë§Œí™”ì°½ì‘ê³¼',
            'ì›¹íˆ°í•™ê³¼', 'ìºë¦­í„°ë””ìì¸ê³¼', 'ê³µê°„ë””ìì¸ê³¼', 'ê´‘ê³ ë””ìì¸ê³¼', 'ë””ì§€í„¸ì•„íŠ¸ê³¼',
            'ì„¬ìœ ë””ìì¸ê³¼', 'ì£¼ì–¼ë¦¬ë””ìì¸ê³¼', 'ë„ì˜ˆê³¼', 'ë¯¸ë””ì–´ì•„íŠ¸ê³¼', 'ì‚¬ì§„í•™ê³¼',
            'ì˜ìƒí•™ê³¼', 'ë°©ì†¡ì œì‘ê³¼', 'ê´‘ê³ ì œì‘ê³¼', 'ê¸°íƒ€ê³¼', 'íƒ€ì•…ê¸°ê³¼',
            'ë°”ì´ì˜¬ë¦°ê³¼', 'ì²¼ë¡œê³¼', 'í”Œë£¨íŠ¸ê³¼', 'ìƒ‰ì†Œí°ê³¼', 'íŠ¸ëŸ¼í«ê³¼',
            'ì¬ì¦ˆê³¼', 'êµíšŒìŒì•…ê³¼', 'ìŒí–¥ìŒì•…ê³¼', 'ìŒì•…ì¹˜ë£Œí•™ê³¼', 'ë¬´ëŒ€ë””ìì¸ê³¼',
            'ì—°ê·¹í•™ê³¼', 'ì˜í™”ì œì‘ê³¼', 'ì‹œë‚˜ë¦¬ì˜¤í•™ê³¼', 'ì˜í™”ì´ë¡ ê³¼',

            // ì˜ì•½í•™ê³„ì—´
            'ë¬¼ë¦¬ì¹˜ë£Œí•™ê³¼', 'ë°©ì‚¬ì„ í•™ê³¼', 'ë³´ê±´ê´€ë¦¬í•™ê³¼', 'ë³´ê±´í–‰ì •í•™ê³¼', 'ìˆ˜ì˜í•™ê³¼',
            'ì•ˆê²½ê´‘í•™ê³¼', 'ì•½í•™ê³¼', 'ì–¸ì–´ì¹˜ë£Œí•™ê³¼', 'ì˜ë£Œê²½ì˜í•™ê³¼', 'ì˜ì˜ˆê³¼',
            'ì˜í•™ê³¼', 'ì‘ì—…ì¹˜ë£Œí•™ê³¼', 'ì¬í™œí•™ê³¼', 'ì‘ê¸‰êµ¬ì¡°í•™ê³¼', 'ì¹˜ìœ„ìƒí•™ê³¼',
            'ì¹˜ì˜ì˜ˆê³¼', 'ì¹˜ì˜í•™ê³¼', 'í•œì•½í•™ê³¼', 'í•œì˜ì˜ˆê³¼', 'í•œì˜í•™ê³¼',
            'ì¹˜ê¸°ê³µí•™ê³¼', 'ì˜ë¬´ê¸°ë¡í•™ê³¼', 'ë³´ê±´ì˜ë£Œì •ë³´í•™ê³¼', 'ë³´ê±´í™˜ê²½í•™ê³¼', 'ì„ìƒë³‘ë¦¬í•™ê³¼',
            'ë°©ì‚¬ì„ í•™ê³¼', 'í”¼ë¶€ë¯¸ìš©í•™ê³¼', 'í—¤ì–´ë””ìì¸í•™ê³¼', 'ë·°í‹°ì¼€ì–´í•™ê³¼', 'ìŠ¤í¬ì¸ ì¬í™œí•™ê³¼',

            // ë†ìˆ˜ì‚°í•™ê³„ì—´
            'ë†ì—…ê²½ì œí•™ê³¼', 'ë†ì—…ìƒëª…ê³¼í•™ê³¼', 'ë†í•™ê³¼', 'ë™ë¬¼ìƒëª…ê³µí•™ê³¼', 'ë™ë¬¼ìì›í•™ê³¼',
            'ì‚°ë¦¼ê³¼í•™ê³¼', 'ì‚°ë¦¼ìì›í•™ê³¼', 'ìˆ˜ì‚°ìƒëª…ì˜í•™ê³¼', 'ìˆ˜ì‚°ì–‘ì‹í•™ê³¼', 'ì‹ë¬¼ìƒëª…ê³¼í•™ê³¼',
            'ì›ì˜ˆí•™ê³¼', 'ì¡°ê²½í•™ê³¼', 'ì¶•ì‚°í•™ê³¼', 'íŠ¹ìš©ì‹ë¬¼í•™ê³¼', 'í•´ì–‘ìˆ˜ì‚°ê²½ì˜í•™ê³¼',
            'í•´ì–‘ìì›í•™ê³¼', 'í•´ì–‘í™˜ê²½í•™ê³¼', 'ìˆ˜ì˜ì˜ˆê³¼', 'ë™ë¬¼ìì›ê³¼í•™ê³¼', 'ë°”ì´ì˜¤ì‚°ì—…í•™ê³¼',

            // ìƒí™œê³¼í•™ê³„ì—´
            'ê°€ì¡±ë³µì§€í•™ê³¼', 'ê°€ì •ê´€ë¦¬í•™ê³¼', 'ì†Œë¹„ìì•„ë™í•™ê³¼', 'ì•„ë™ê°€ì¡±í•™ê³¼', 'ì•„ë™ë³µì§€í•™ê³¼',
            'ì•„ë™í•™ê³¼', 'ì˜ë¥˜í•™ê³¼', 'ì˜ìƒí•™ê³¼', 'ì‹í’ˆì˜ì–‘í•™ê³¼', 'ì£¼ê±°í™˜ê²½í•™ê³¼',
            'ì†Œë¹„ìí•™ê³¼', 'ìƒí™œë¬¸í™”í•™ê³¼',

            // í•™ë¶€/ììœ¨ì „ê³µ
            'ììœ ì „ê³µí•™ë¶€', 'ììœ¨ì „ê³µí•™ë¶€', 'ìœµí•©ì „ê³µí•™ë¶€', 'ë¯¸ë˜ìœµí•©í•™ë¶€', 'ì°½ì˜ìœµí•©í•™ë¶€',
            'ê¸€ë¡œë²Œí•™ë¶€', 'êµ­ì œí•™ë¶€', 'ììœ ì „ê³µ', 'í•™ë¶€ëŒ€í•™', 'ìœµí•©ì¸ì¬í•™ë¶€'
        ].sort();

        // ì „ì²´ í•™ê³¼ ëª©ë¡ ë³´ì—¬ì£¼ê¸°
        window.showAllDepartments = function() {
            const input = document.getElementById('department');
            const currentValue = input.value.trim();

            if (currentValue === '') {
                displayDepartmentSuggestions(allDepartments);
            } else {
                // í˜„ì¬ ì…ë ¥ëœ ê°’ìœ¼ë¡œ ê²€ìƒ‰ ì‹¤í–‰
                const filtered = allDepartments.filter(dept =>
                    dept.toLowerCase().includes(currentValue.toLowerCase())
                );
                displayDepartmentSuggestions(filtered);
            }
        }

        // í•™ê³¼/ì „ê³µ ê²€ìƒ‰ í•¨ìˆ˜
        window.searchDepartment = function(query) {
            clearTimeout(departmentSearchTimeout);

            if (query.length < 1) {
                // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ì „ì²´ ëª©ë¡ í‘œì‹œ
                displayDepartmentSuggestions(allDepartments);
                return;
            }

            departmentSearchTimeout = setTimeout(() => {
                const filtered = allDepartments.filter(dept =>
                    dept.toLowerCase().includes(query.toLowerCase())
                );

                displayDepartmentSuggestions(filtered);
            }, 200);
        }

        // í•™ê³¼ ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
        function displayDepartmentSuggestions(departments) {
            const suggestionsDiv = document.getElementById('departmentSuggestions');
            suggestionsDiv.innerHTML = '';

            if (departments.length === 0) {
                suggestionsDiv.innerHTML = '<div style="padding: 15px; color: #666; text-align: center;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                suggestionsDiv.style.display = 'block';
                return;
            }

            // ê²€ìƒ‰ ê²°ê³¼ ê°œìˆ˜ í‘œì‹œ
            if (departments.length < allDepartments.length) {
                const countHeader = document.createElement('div');
                countHeader.style.cssText = 'padding: 10px 12px; background: #fef9c3; font-weight: 600; color: #92400e; border-bottom: 2px solid #ca8a04; position: sticky; top: 0; z-index: 10;';
                countHeader.textContent = `ê²€ìƒ‰ ê²°ê³¼ ${departments.length}ê°œ`;
                suggestionsDiv.appendChild(countHeader);
            } else {
                const countHeader = document.createElement('div');
                countHeader.style.cssText = 'padding: 10px 12px; background: #fef3c7; font-weight: 600; color: #92400e; border-bottom: 2px solid #ca8a04; position: sticky; top: 0; z-index: 10;';
                countHeader.textContent = `ì „ì²´ í•™ê³¼ ëª©ë¡ (${departments.length}ê°œ) - ìŠ¤í¬ë¡¤í•˜ì—¬ ì°¾ê±°ë‚˜ ê²€ìƒ‰í•˜ì„¸ìš”`;
                suggestionsDiv.appendChild(countHeader);
            }

            departments.forEach(dept => {
                const item = document.createElement('div');
                item.style.cssText = 'padding: 12px 15px; cursor: pointer; border-bottom: 1px solid #f0f0f0; transition: all 0.2s; font-size: 0.95em;';
                item.textContent = dept;

                item.addEventListener('mouseenter', () => {
                    item.style.background = '#fef9c3';
                    item.style.paddingLeft = '20px';
                });
                item.addEventListener('mouseleave', () => {
                    item.style.background = 'white';
                    item.style.paddingLeft = '15px';
                });
                item.addEventListener('click', () => {
                    selectDepartment(dept);
                });

                suggestionsDiv.appendChild(item);
            });

            suggestionsDiv.style.display = 'block';
        }

        // í•™ê³¼ ì„ íƒ
        function selectDepartment(dept) {
            document.getElementById('department').value = dept;
            document.getElementById('departmentSuggestions').style.display = 'none';
        }

        // ì™¸ë¶€ í´ë¦­ ì‹œ í•™ê³¼ ê²€ìƒ‰ ê²°ê³¼ ë‹«ê¸°
        document.addEventListener('click', (e) => {
            if (!e.target.closest('#department') && !e.target.closest('#departmentSuggestions')) {
                document.getElementById('departmentSuggestions').style.display = 'none';
            }
        });

        // í•™êµ ê²€ìƒ‰ í•¨ìˆ˜ (ê¸€ë¡œë²Œ ìŠ¤ì½”í”„ì— ëª…ì‹œì ìœ¼ë¡œ í• ë‹¹)
        window.searchSchool = async function(query) {
            clearTimeout(searchTimeout);

            if (query.length < 2) {
                document.getElementById('schoolSuggestions').style.display = 'none';
                return;
            }

            searchTimeout = setTimeout(async () => {
                try {
                    // í•™êµì•Œë¦¬ë¯¸ API - í•™êµê¸°ë³¸ì •ë³´ ì¡°íšŒ
                    const url = `https://open.neis.go.kr/hub/schoolInfo?KEY=${NEIS_API_KEY}&Type=json&SCHUL_NM=${encodeURIComponent(query)}&SCHUL_KND_SC_NM=ê³ ë“±í•™êµ`;

                    const response = await fetch(url);
                    const data = await response.json();

                    if (data.schoolInfo && data.schoolInfo[1] && data.schoolInfo[1].row) {
                        const schools = data.schoolInfo[1].row;
                        displaySchoolSuggestions(schools);
                    } else {
                        document.getElementById('schoolSuggestions').innerHTML = '<div style="padding: 10px; color: #666;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                        document.getElementById('schoolSuggestions').style.display = 'block';
                    }
                } catch (error) {
                    console.error('í•™êµ ê²€ìƒ‰ ì˜¤ë¥˜:', error);
                    document.getElementById('schoolSuggestions').innerHTML = '<div style="padding: 10px; color: #ef4444;">ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
                    document.getElementById('schoolSuggestions').style.display = 'block';
                }
            }, 300);
        }

        // í•™êµ ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
        function displaySchoolSuggestions(schools) {
            const suggestionsDiv = document.getElementById('schoolSuggestions');
            suggestionsDiv.innerHTML = '';

            schools.forEach(school => {
                const item = document.createElement('div');
                item.style.cssText = 'padding: 12px; cursor: pointer; border-bottom: 1px solid #f0f0f0; transition: background 0.2s;';
                item.innerHTML = `
                    <div style="font-weight: 600; color: #333;">${school.SCHUL_NM}</div>
                    <div style="font-size: 0.85em; color: #666; margin-top: 4px;">
                        ${school.ORG_RDNMA} | ${school.SCHUL_KND_SC_NM} | ${school.FOND_SC_NM}
                    </div>
                `;

                item.addEventListener('mouseenter', () => {
                    item.style.background = '#fef9c3';
                });
                item.addEventListener('mouseleave', () => {
                    item.style.background = 'white';
                });
                item.addEventListener('click', () => {
                    selectSchool(school);
                });

                suggestionsDiv.appendChild(item);
            });

            suggestionsDiv.style.display = 'block';
        }

        // í•™êµ ì„ íƒ
        async function selectSchool(school) {
            document.getElementById('schoolName').value = school.SCHUL_NM;
            document.getElementById('schoolSuggestions').style.display = 'none';
            selectedSchoolCode = {
                SD_SCHUL_CODE: school.SD_SCHUL_CODE,
                ATPT_OFCDC_SC_CODE: school.ATPT_OFCDC_SC_CODE
            };

            // í•™êµ ì •ë³´ í‘œì‹œ
            document.getElementById('schoolInfo').innerHTML = `
                <div style="padding: 10px; background: #fef9c3; border-left: 4px solid #ca8a04; border-radius: 5px;">
                    âœ“ <strong>${school.SCHUL_NM}</strong> ì„ íƒë¨<br>
                    ğŸ“ ${school.ORG_RDNMA}<br>
                    ğŸ« ${school.SCHUL_KND_SC_NM} | ${school.FOND_SC_NM}
                </div>
            `;

            // êµìœ¡ê³¼ì • ì •ë³´ ë¡œë“œ
            await loadCurriculum(selectedSchoolCode);
        }

        // êµìœ¡ê³¼ì • ì •ë³´ ë¡œë“œ
        async function loadCurriculum(schoolCode) {
            try {
                // í•™êµì•Œë¦¬ë¯¸ API - í•™ê³¼ì •ë³´ ì¡°íšŒ (ì˜ˆì‹œ)
                const year = new Date().getFullYear();
                const url = `https://open.neis.go.kr/hub/schoolMajorinfo?KEY=${NEIS_API_KEY}&Type=json&ATPT_OFCDC_SC_CODE=${schoolCode.ATPT_OFCDC_SC_CODE}&SD_SCHUL_CODE=${schoolCode.SD_SCHUL_CODE}&AY=${year}`;

                const response = await fetch(url);
                const data = await response.json();

                console.log('êµìœ¡ê³¼ì • ë°ì´í„°:', data);

                // êµìœ¡ê³¼ì • ì •ë³´ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥í•˜ì—¬ ë‚˜ì¤‘ì— ì‚¬ìš©
                window.curriculumData = data;

            } catch (error) {
                console.error('êµìœ¡ê³¼ì • ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }

        // ì™¸ë¶€ í´ë¦­ ì‹œ ê²€ìƒ‰ ê²°ê³¼ ë‹«ê¸°
        document.addEventListener('click', (e) => {
            if (!e.target.closest('#schoolName') && !e.target.closest('#schoolSuggestions')) {
                document.getElementById('schoolSuggestions').style.display = 'none';
            }
        });
    </script>
    <script src="js/header-common.js"></script>
</body>
</html>
